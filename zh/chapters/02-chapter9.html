<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book C 語言編程透視 -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>代碼測試、調試與優化 | C 語言編程透視</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.1.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-google_code_prettify/google-code-prettify.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-maxiang/maxiang.css">
        
    
    

        
    
    
    
    <link rel="prev" href="../../zh/chapters/02-chapter8.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <div class="book" data-level="11" data-basepath="../.." data-revision="Wed Sep 02 2015 19:26:26 GMT+0800 (CST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="zh/preface/01-chapter0.html">
            
                
                    <a href="../../zh/preface/01-chapter0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        版本修訂歷史
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="zh/preface/01-chapter1.html">
            
                
                    <a href="../../zh/preface/01-chapter1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        前言
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="zh/chapters/02-chapter1.html">
            
                
                    <a href="../../zh/chapters/02-chapter1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        把 Vim 打造成源代碼編輯器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="zh/chapters/02-chapter2.html">
            
                
                    <a href="../../zh/chapters/02-chapter2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Gcc 編譯的背後
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="zh/chapters/02-chapter3.html">
            
                
                    <a href="../../zh/chapters/02-chapter3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        程序執行的一剎那
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="zh/chapters/02-chapter4.html">
            
                
                    <a href="../../zh/chapters/02-chapter4.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        動態符號鏈接的細節
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="zh/chapters/02-chapter5.html">
            
                
                    <a href="../../zh/chapters/02-chapter5.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        緩衝區溢出與注入分析
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="zh/chapters/02-chapter6.html">
            
                
                    <a href="../../zh/chapters/02-chapter6.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        進程的內存映像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="zh/chapters/02-chapter7.html">
            
                
                    <a href="../../zh/chapters/02-chapter7.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        進程和進程的基本操作
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="zh/chapters/02-chapter8.html">
            
                
                    <a href="../../zh/chapters/02-chapter8.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        打造史上最小可執行ELF文件(45字節)
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="11" data-path="zh/chapters/02-chapter9.html">
            
                
                    <a href="../../zh/chapters/02-chapter9.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        代碼測試、調試與優化
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >C 語言編程透視</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="%E4%BB%A3%E7%A2%BC%E6%B8%AC%E8%A9%A6%E3%80%81%E8%AA%BF%E8%A9%A6%E8%88%87%E5%84%AA%E5%8C%96">&#x4EE3;&#x78BC;&#x6E2C;&#x8A66;&#x3001;&#x8ABF;&#x8A66;&#x8207;&#x512A;&#x5316;</h1>
<ul>
<li><a href="#toc_7140_15195_1">&#x524D;&#x8A00;</a></li>
<li><a href="#toc_7140_15195_2">&#x4EE3;&#x78BC;&#x6E2C;&#x8A66;</a><ul>
<li><a href="#toc_7140_15195_3">&#x6E2C;&#x8A66;&#x7A0B;&#x5E8F;&#x7684;&#x904B;&#x884C;&#x6642;&#x9593; time</a></li>
<li><a href="#toc_7140_15195_4">&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x5716; calltree</a></li>
<li><a href="#toc_7140_15195_5">&#x6027;&#x80FD;&#x6E2C;&#x8A66;&#x5DE5;&#x5177; gprof &amp; kprof</a></li>
<li><a href="#toc_7140_15195_6">&#x4EE3;&#x78BC;&#x8986;&#x84CB;&#x7387;&#x6E2C;&#x8A66; gcov &amp; ggcov</a></li>
<li><a href="#toc_7140_15195_7">&#x5167;&#x5B58;&#x8A2A;&#x554F;&#x8D8A;&#x754C; catchsegv, libSegFault.so</a></li>
<li><a href="#toc_7140_15195_8">&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA; libsafe.so</a></li>
<li><a href="#toc_7140_15195_9">&#x5167;&#x5B58;&#x6D29;&#x9732; Memwatch, Valgrind, mtrace</a></li>
</ul>
</li>
<li><a href="#toc_7140_15195_10">&#x4EE3;&#x78BC;&#x8ABF;&#x8A66;</a><ul>
<li><a href="#toc_7140_15195_11">&#x975C;&#x614B;&#x8ABF;&#x8A66;&#xFF1A;printf + gcc -D&#xFF08;&#x6253;&#x5370;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x8B8A;&#x91CF;&#xFF09;</a></li>
<li><a href="#toc_7140_15195_12">&#x4EA4;&#x4E92;&#x5F0F;&#x7684;&#x8ABF;&#x8A66;&#xFF08;&#x52D5;&#x614B;&#x8ABF;&#x8A66;&#xFF09;&#xFF1A;gdb&#xFF08;&#x652F;&#x6301;&#x672C;&#x5730;&#x548C;&#x9060;&#x7A0B;&#xFF09;/ald&#xFF08;&#x5F59;&#x7DE8;&#x6307;&#x4EE4;&#x7D1A;&#x5225;&#x7684;&#x8ABF;&#x8A66;&#xFF09;</a><ul>
<li><a href="#toc_7140_15195_13">&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x8ABF;&#x8A66;&#x65B9;&#x6CD5; gdbserver/gdb</a></li>
<li><a href="#toc_7140_15195_14">&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#x7684;&#x8ABF;&#x8A66; ald</a></li>
</ul>
</li>
<li><a href="#toc_7140_15195_15">&#x5BE6;&#x6642;&#x8ABF;&#x8A66;&#xFF1A;gdb tracepoint</a></li>
<li><a href="#toc_7140_15195_16">&#x8ABF;&#x8A66;&#x5167;&#x6838;</a></li>
</ul>
</li>
<li><a href="#toc_7140_15195_17">&#x4EE3;&#x78BC;&#x512A;&#x5316;</a></li>
<li><a href="#toc_7140_15195_18">&#x53C3;&#x8003;&#x8CC7;&#x6599;</a></li>
</ul>
<p><span id="toc_7140_15195_1"></span></p>
<h2 id="%E5%89%8D%E8%A8%80">&#x524D;&#x8A00;</h2>
<p>&#x4EE3;&#x78BC;&#x5BEB;&#x5B8C;&#x4EE5;&#x5F8C;&#x5F80;&#x5F80;&#x8981;&#x505A;&#x6E2C;&#x8A66;&#xFF08;&#x6216;&#x9A57;&#x8B49;&#xFF09;&#x3001;&#x8ABF;&#x8A66;&#xFF0C;&#x53EF;&#x80FD;&#x9084;&#x8981;&#x512A;&#x5316;&#x3002;</p>
<ul>
<li><p>&#x95DC;&#x65BC;&#x6E2C;&#x8A66;&#xFF08;&#x6216;&#x9A57;&#x8B49;&#xFF09;</p>
<p>&#x901A;&#x5E38;&#x5C0D;&#x61C9;&#x8457;&#x5169;&#x500B;&#x82F1;&#x6587;&#x55AE;&#x8A5E; <code>Verification&#x548C;</code>Validation`&#xFF0C;&#x5728;&#x8CC7;&#x6599; <a href="http://satc.gsfc.nasa.gov/assure/agbsec5.txt" target="_blank">[1]</a> &#x4E2D;&#x6709;&#x95DC;&#x65BC;&#x9019;&#x500B;&#x7684;&#x5B9A;&#x7FA9;&#x548C;&#x4E00;&#x4E9B;&#x6DF1;&#x5165;&#x7684;&#x8A0E;&#x8AD6;&#xFF0C;&#x5728;&#x8CC7;&#x6599; <a href="http://www.faqs.org/qa/qa-9060.html" target="_blank">[2]</a> &#x4E2D;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x7D66;&#x51FA;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x770B;&#x6CD5;&#x3002;&#x4F46;&#x662F;&#x6B63;&#x5982;&#x8CC7;&#x6599; <a href="http://www.faqs.org/qa/qa-9060.html" target="_blank">[2]</a> &#x63D0;&#x5230;&#x7684;&#xFF1A;</p>
<blockquote>
<p>The differences between verification and validation are unimportant except to the theorist; practitioners use the term V&amp;V to refer to all of the activities that are aimed at making sure the software will function as required.</p>
</blockquote>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x7121;&#x8AD6;&#x6E2C;&#x8A66;&#xFF08;&#x6216;&#x9A57;&#x8B49;&#xFF09;&#x76EE;&#x7684;&#x90FD;&#x662F;&#x70BA;&#x4E86;&#x8B93;&#x8EDF;&#x4EF6;&#x7684;&#x529F;&#x80FD;&#x80FD;&#x5920;&#x9054;&#x5230;&#x9700;&#x6C42;&#x3002;&#x6E2C;&#x8A66;&#x548C;&#x9A57;&#x8B49;&#x901A;&#x5E38;&#x6703;&#x901A;&#x904E;&#x4E00;&#x4E9B;&#x5F62;&#x5F0F;&#x5316;&#xFF08;&#x8C8C;&#x4F3C;&#x53EF;&#x4EE5;&#x7C21;&#x55AE;&#x5730;&#x8A8D;&#x70BA;&#x6709;&#x6578;&#x5B78;&#x6839;&#x64DA;&#x7684;&#xFF09;&#x6216;&#x8005;&#x975E;&#x5F62;&#x5F0F;&#x5316;&#x7684;&#x65B9;&#x6CD5;&#x53BB;&#x9A57;&#x8B49;&#x7A0B;&#x5E8F;&#x7684;&#x529F;&#x80FD;&#x662F;&#x5426;&#x9054;&#x5230;&#x8981;&#x6C42;&#x3002;</p>
</li>
<li><p>&#x95DC;&#x65BC;&#x8ABF;&#x8A66;</p>
<p>&#x800C;&#x8ABF;&#x8A66;&#x5C0D;&#x61C9;&#x82F1;&#x6587; debug&#xFF0C;debug &#x53EB;&#x201C;&#x9A45;&#x9664;&#x5BB3;&#x87F2;&#x201D;&#xFF0C;&#x4E5F;&#x8A31;&#x4E00;&#x500B;&#x8EDF;&#x4EF6;&#x7684;&#x529F;&#x80FD;&#x9054;&#x5230;&#x4E86;&#x8981;&#x6C42;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x80FD;&#x6703;&#x5728;&#x6E2C;&#x8A66;&#x6216;&#x8005;&#x662F;&#x6B63;&#x5E38;&#x904B;&#x884C;&#x6642;&#x51FA;&#x73FE;&#x7570;&#x5E38;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x8655;&#x7406;&#x5B83;&#x5011;&#x3002;</p>
</li>
<li><p>&#x95DC;&#x65BC;&#x512A;&#x5316;</p>
<p>debug &#x662F;&#x70BA;&#x4E86;&#x4FDD;&#x8B49;&#x7A0B;&#x5E8F;&#x7684;&#x6B63;&#x78BA;&#x6027;&#xFF0C;&#x4E4B;&#x5F8C;&#x5C31;&#x9700;&#x8981;&#x8003;&#x616E;&#x7A0B;&#x5E8F;&#x7684;&#x57F7;&#x884C;&#x6548;&#x7387;&#xFF0C;&#x5C0D;&#x65BC;&#x5B58;&#x5132;&#x8CC7;&#x6E90;&#x53D7;&#x9650;&#x7684;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#xFF0C;&#x7A0B;&#x5E8F;&#x7684;&#x5927;&#x5C0F;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x512A;&#x5316;&#x7684;&#x5C0D;&#x8C61;&#x3002;</p>
<p>&#x5F88;&#x591A;&#x7406;&#x8AD6;&#x6027;&#x7684;&#x6771;&#x897F;&#x5BE6;&#x5728;&#x6C92;&#x6709;&#x7814;&#x7A76;&#x904E;&#xFF0C;&#x66AB;&#x4E14;&#x4E0D;&#x8AAA;&#x5427;&#x3002;&#x9019;&#x88E1;&#x53EA;&#x662F;&#x60F3;&#x628A;&#x4E00;&#x4E9B;&#x9700;&#x8981;&#x52D5;&#x624B;&#x5BE6;&#x8E10;&#x7684;&#x6771;&#x897F;&#x5148;&#x4E14;&#x8A18;&#x9304;&#x548C;&#x7E3D;&#x7D50;&#x4E00;&#x4E0B;&#xFF0C;&#x53E6;&#x5916;&#x5F88;&#x591A;&#x5DE5;&#x5177;&#x5728;&#x9019;&#x88E1;&#x90FD;&#x6709;&#x63D0;&#x5230;&#x548C;&#x7F85;&#x5217;&#xFF0C;&#x5305;&#x62EC; Linux &#x5167;&#x6838;&#x8ABF;&#x8A66;&#x76F8;&#x95DC;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x5DE5;&#x5177;&#x3002;&#x95DC;&#x65BC;&#x66F4;&#x8A73;&#x7D30;&#x66F4;&#x6DF1;&#x5165;&#x7684;&#x5167;&#x5BB9;&#x9084;&#x662F;&#x5EFA;&#x8B70;&#x76F4;&#x63A5;&#x770B;&#x5F8C;&#x9762;&#x7684;&#x53C3;&#x8003;&#x8CC7;&#x6599;&#x70BA;&#x5999;&#x3002;</p>
</li>
</ul>
<p>&#x4E0B;&#x9762;&#x7684;&#x6240;&#x6709;&#x6F14;&#x793A;&#x5728;&#x5982;&#x4E0B;&#x74B0;&#x5883;&#x4E0B;&#x9032;&#x884C;&#xFF1A;</p>
<pre><code>$ uname -a
Linux falcon 2.6.22-14-generic #1 SMP Tue Feb 12 07:42:25 UTC 2008 i686 GNU/Linux
$ echo $SHELL
/bin/bash
$ /bin/bash --version | grep bash
GNU bash, version 3.2.25(1)-release (i486-pc-linux-gnu)
$ gcc --version | grep gcc
gcc (GCC) 4.1.3 20070929 (prerelease) (Ubuntu 4.1.2-16ubuntu2)
$ cat /proc/cpuinfo | grep &quot;model name&quot;
model name      : Intel(R) Pentium(R) 4 CPU 2.80GHz
</code></pre><p><span id="toc_7140_15195_2"></span></p>
<h2 id="%E4%BB%A3%E7%A2%BC%E6%B8%AC%E8%A9%A6">&#x4EE3;&#x78BC;&#x6E2C;&#x8A66;</h2>
<p>&#x4EE3;&#x78BC;&#x6E2C;&#x8A66;&#x6709;&#x5F88;&#x591A;&#x65B9;&#x9762;&#xFF0C;&#x4F8B;&#x5982;&#x904B;&#x884C;&#x6642;&#x9593;&#x3001;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x5716;&#x3001;&#x4EE3;&#x78BC;&#x8986;&#x84CB;&#x5EA6;&#x3001;&#x6027;&#x80FD;&#x5206;&#x6790;&#xFF08;Profiling&#xFF09;&#x3001;&#x5167;&#x5B58;&#x8A2A;&#x554F;&#x8D8A;&#x754C;&#xFF08;Segmentation Fault&#xFF09;&#x3001;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#xFF08;Stack Smashing &#x5408;&#x6CD5;&#x5730;&#x9032;&#x884C;&#x975E;&#x6CD5;&#x7684;&#x5167;&#x5B58;&#x8A2A;&#x554F;&#xFF1F;&#x6240;&#x4EE5;&#x5F88;&#x5371;&#x96AA;&#xFF09;&#x3001;&#x5167;&#x5B58;&#x6D29;&#x9732;&#xFF08;Memory Leak&#xFF09;&#x7B49;&#x3002;</p>
<p><span id="toc_7140_15195_3"></span></p>
<h3 id="%E6%B8%AC%E8%A9%A6%E7%A8%8B%E5%BA%8F%E7%9A%84%E9%81%8B%E8%A1%8C%E6%99%82%E9%96%93-time">&#x6E2C;&#x8A66;&#x7A0B;&#x5E8F;&#x7684;&#x904B;&#x884C;&#x6642;&#x9593; time</h3>
<p>Shell &#x63D0;&#x4F9B;&#x4E86;&#x5167;&#x7F6E;&#x547D;&#x4EE4; <code>time</code> &#x7528;&#x65BC;&#x6E2C;&#x8A66;&#x7A0B;&#x5E8F;&#x7684;&#x57F7;&#x884C;&#x6642;&#x9593;&#xFF0C;&#x9ED8;&#x8A8D;&#x986F;&#x793A;&#x7D50;&#x679C;&#x5305;&#x62EC;&#x4E09;&#x90E8;&#x5206;&#xFF1A;&#x5BE6;&#x969B;&#x82B1;&#x8CBB;&#x6642;&#x9593;&#xFF08;real time&#xFF09;&#x3001;&#x7528;&#x6236;&#x7A7A;&#x9593;&#x82B1;&#x8CBB;&#x6642;&#x9593;&#xFF08;user time&#xFF09;&#x548C;&#x5167;&#x6838;&#x7A7A;&#x9593;&#x82B1;&#x8CBB;&#x6642;&#x9593;&#xFF08;kernel time&#xFF09;&#x3002;</p>
<pre><code>$ time pstree 2&gt;&amp;1 &gt;/dev/null

real    0m0.024s
user    0m0.008s
sys     0m0.004s
</code></pre><p><code>time</code> &#x547D;&#x4EE4;&#x7D66;&#x51FA;&#x4E86;&#x7A0B;&#x5E8F;&#x672C;&#x8EAB;&#x7684;&#x904B;&#x884C;&#x6642;&#x9593;&#x3002;&#x9019;&#x500B;&#x6E2C;&#x8A66;&#x539F;&#x7406;&#x975E;&#x5E38;&#x7C21;&#x55AE;&#xFF0C;&#x5C31;&#x662F;&#x5728;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#xFF08;&#x901A;&#x904E; <code>system</code> &#x51FD;&#x6578;&#x57F7;&#x884C;&#xFF09;&#x524D;&#x5F8C;&#x8A18;&#x9304;&#x4E86;&#x7CFB;&#x7D71;&#x6642;&#x9593;&#xFF08;&#x7528; <code>times</code> &#x51FD;&#x6578;&#xFF09;&#xFF0C;&#x7136;&#x5F8C;&#x9032;&#x884C;&#x6C42;&#x5DEE;&#x5C31;&#x53EF;&#x4EE5;&#x3002;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x6642;&#x9593;&#x5F88;&#x77ED;&#xFF0C;&#x904B;&#x884C;&#x4E00;&#x6B21;&#x770B;&#x4E0D;&#x5230;&#x6548;&#x679C;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x63A1;&#x7528;&#x6E2C;&#x8A66;&#x7D19;&#x7247;&#x539A;&#x5EA6;&#x7684;&#x65B9;&#x6CD5;&#x9032;&#x884C;&#x6E2C;&#x8A66;&#xFF0C;&#x985E;&#x4F3C;&#x628A;&#x5F88;&#x591A;&#x7D19;&#x5F35;&#x758A;&#x5230;&#x4E00;&#x8D77;&#x4F86;&#x6E2C;&#x8A66;&#x7D19;&#x5F35;&#x539A;&#x5EA6;&#x4E00;&#x6A23;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x8B93;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x5F88;&#x591A;&#x6B21;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x6642;&#x9593;&#x592A;&#x9577;&#xFF0C;&#x57F7;&#x884C;&#x6548;&#x7387;&#x5F88;&#x4F4E;&#xFF0C;&#x90A3;&#x9EBC;&#x5F97;&#x8003;&#x616E;&#x7A0B;&#x5E8F;&#x5167;&#x90E8;&#x5404;&#x500B;&#x90E8;&#x5206;&#x7684;&#x57F7;&#x884C;&#x60C5;&#x6CC1;&#xFF0C;&#x5F9E;&#x800C;&#x5C0D;&#x4EE3;&#x78BC;&#x9032;&#x884C;&#x53EF;&#x80FD;&#x7684;&#x512A;&#x5316;&#x3002;&#x5177;&#x9AD4;&#x53EF;&#x80FD;&#x6703;&#x8003;&#x616E;&#x5230;&#x9019;&#x5169;&#x9EDE;&#xFF1A;</p>
<p>&#x5C0D;&#x65BC; C &#x8A9E;&#x8A00;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x4E00;&#x500B;&#x6BD4;&#x8F03;&#x5B8F;&#x89C0;&#x7684;&#x5C64;&#x6B21;&#x6027;&#x7684;&#x8F2A;&#x5ED3;&#xFF08;profile&#xFF09;&#x662F;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x5716;&#x3001;&#x51FD;&#x6578;&#x5167;&#x90E8;&#x7684;&#x689D;&#x4EF6;&#x5206;&#x652F;&#x69CB;&#x6210;&#x7684;&#x8A9E;&#x53E5;&#x584A;&#xFF0C;&#x7136;&#x5F8C;&#x5C31;&#x662F;&#x5177;&#x9AD4;&#x7684;&#x8A9E;&#x53E5;&#x3002;&#x628A;&#x63E1;&#x597D;&#x9019;&#x6A23;&#x4E00;&#x500B;&#x8F2A;&#x5ED3;&#x5F8C;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6709;&#x91DD;&#x5C0D;&#x6027;&#x5730;&#x53BB;&#x95DC;&#x6CE8;&#x7A0B;&#x5E8F;&#x7684;&#x5404;&#x500B;&#x90E8;&#x5206;&#xFF0C;&#x5305;&#x62EC;&#x54EA;&#x4E9B;&#x51FD;&#x6578;&#x3001;&#x54EA;&#x4E9B;&#x5206;&#x652F;&#x3001;&#x54EA;&#x4E9B;&#x8A9E;&#x53E5;&#x6700;&#x503C;&#x5F97;&#x95DC;&#x6CE8;&#xFF08;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x8D8A;&#x591A;&#x8D8A;&#x503C;&#x5F97;&#x512A;&#x5316;&#xFF0C;&#x8853;&#x8A9E;&#x53EB; hotspots&#xFF09;&#x3002;</p>
<p>&#x5C0D;&#x65BC; Linux &#x4E0B;&#x7684;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x6642;&#x6D89;&#x53CA;&#x5230;&#x7684;&#x4EE3;&#x78BC;&#x6703;&#x6DB5;&#x84CB;&#x5169;&#x500B;&#x7A7A;&#x9593;&#xFF0C;&#x5373;&#x7528;&#x6236;&#x7A7A;&#x9593;&#x548C;&#x5167;&#x6838;&#x7A7A;&#x9593;&#x3002;&#x7531;&#x65BC;&#x9019;&#x5169;&#x500B;&#x7A7A;&#x9593;&#x6D89;&#x53CA;&#x5230;&#x5730;&#x5740;&#x7A7A;&#x9593;&#x7684;&#x9694;&#x96E2;&#xFF0C;&#x5728;&#x6E2C;&#x8A66;&#x6216;&#x8ABF;&#x8A66;&#x6642;&#xFF0C;&#x53EF;&#x80FD;&#x6D89;&#x53CA;&#x5230;&#x5169;&#x500B;&#x7A7A;&#x9593;&#x7684;&#x5DE5;&#x5177;&#x3002;&#x524D;&#x8005;&#x7D55;&#x5927;&#x591A;&#x6578;&#x662F;&#x57FA;&#x65BC; <code>Gcc</code> &#x7684;&#x7279;&#x5B9A;&#x53C3;&#x6578;&#x548C;&#x7CFB;&#x7D71;&#x7684; <code>ptrace</code> &#x8ABF;&#x7528;&#xFF0C;&#x800C;&#x5F8C;&#x8005;&#x5F80;&#x5F80;&#x5BE6;&#x73FE;&#x70BA;&#x5167;&#x6838;&#x7684;&#x88DC;&#x4E01;&#xFF0C;&#x5B83;&#x5011;&#x5728;&#x539F;&#x7406;&#x4E0A;&#x53EF;&#x80FD;&#x985E;&#x4F3C;&#xFF0C;&#x4F46;&#x5BE6;&#x969B;&#x64CD;&#x4F5C;&#x6642;&#x5F8C;&#x8005;&#x986F;&#x7136;&#x6703;&#x66F4;&#x9EBB;&#x7169;&#xFF0C;&#x4E0D;&#x904E;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x53BB; hack &#x5167;&#x6838;&#xFF0C;&#x90A3;&#x9EBC;&#x5F80;&#x5F80;&#x7121;&#x9808;&#x95DC;&#x5FC3;&#x5F8C;&#x8005;&#x3002;</p>
<p><span id="toc_7140_15195_4"></span></p>
<h3 id="%E5%87%BD%E6%95%B8%E8%AA%BF%E7%94%A8%E9%97%9C%E4%BF%82%E5%9C%96-calltree">&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x5716; calltree</h3>
<p><code>calltree</code> &#x53EF;&#x4EE5;&#x975E;&#x5E38;&#x7C21;&#x55AE;&#x65B9;&#x4FBF;&#x5730;&#x53CD;&#x61C9;&#x4E00;&#x500B;&#x9805;&#x76EE;&#x7684;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x5716;&#xFF0C;&#x96D6;&#x7136;&#x8AF8;&#x5982; <code>gprof</code> &#x9019;&#x6A23;&#x7684;&#x5DE5;&#x5177;&#x4E5F;&#x80FD;&#x505A;&#x5230;&#xFF0C;&#x4E0D;&#x904E;&#x5982;&#x679C;&#x50C5;&#x50C5;&#x8981;&#x5F97;&#x5230;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x5716;&#xFF0C;<code>calltree</code> &#x61C9;&#x8A72;&#x662F;&#x66F4;&#x597D;&#x7684;&#x9078;&#x64C7;&#x3002;&#x5982;&#x679C;&#x8981;&#x7522;&#x751F;&#x5716;&#x5F62;&#x5316;&#x7684;&#x8F38;&#x51FA;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x7684; <code>-dot</code> &#x53C3;&#x6578;&#x3002;&#x5F9E;<a href="ftp://ftp.berlios.de/pub/calltree/calltree-2.3.tar.bz2" target="_blank">&#x9019;&#x88E1;</a>&#x53EF;&#x4EE5;&#x4E0B;&#x8F09;&#x5230;&#x5B83;&#x3002;</p>
<p>&#x9019;&#x88E1;&#x662F;&#x4E00;&#x4EFD;&#x57FA;&#x672C;&#x7528;&#x6CD5;&#x6F14;&#x793A;&#x7D50;&#x679C;&#xFF1A;</p>
<pre><code>$ calltree -b -np -m *.c
main:
|   close
|   commitchanges
|   |   err
|   |   |   fprintf
|   |   ferr
|   |   ftruncate
|   |   lseek
|   |   write
|   ferr
|   getmemorysize
|   modifyheaders
|   open
|   printf
|   readelfheader
|   |   err
|   |   |   fprintf
|   |   ferr
|   |   read
|   readphdrtable
|   |   err
|   |   |   fprintf
|   |   ferr
|   |   malloc
|   |   read
|   truncatezeros
|   |   err
|   |   |   fprintf
|   |   ferr
|   |   lseek
|   |   read$
</code></pre><p>&#x9019;&#x6A23;&#x4E00;&#x4EFD;&#x7D50;&#x679C;&#x5C0D;&#x65BC;&#x201C;&#x53CD;&#x5411;&#x5DE5;&#x7A0B;&#x201D;&#x61C9;&#x8A72;&#x6703;&#x5F88;&#x6709;&#x5E6B;&#x52A9;&#xFF0C;&#x5B83;&#x80FD;&#x5920;&#x5448;&#x73FE;&#x4E00;&#x500B;&#x7A0B;&#x5E8F;&#x7684;&#x5927;&#x9AD4;&#x7D50;&#x69CB;&#xFF0C;&#x5C0D;&#x65BC;&#x95B1;&#x8B80;&#x548C;&#x5206;&#x6790;&#x6E90;&#x4EE3;&#x78BC;&#x4F86;&#x8AAA;&#x662F;&#x4E00;&#x500B;&#x975E;&#x5E38;&#x597D;&#x7684;&#x9078;&#x64C7;&#x3002;&#x96D6;&#x7136; <code>cscope</code> &#x548C; <code>ctags</code> &#x4E5F;&#x80FD;&#x5920;&#x63D0;&#x4F9B;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x7684;&#x201C;&#x5373;&#x6642;&#x201D;&#xFF08;&#x5728;&#x7DE8;&#x8F2F; Vim &#x7684;&#x904E;&#x7A0B;&#x4E2D;&#x9032;&#x884C;&#x8ABF;&#x7528;&#xFF09;&#x8996;&#x5716;&#xFF08;view&#xFF09;&#xFF0C;&#x4F46;&#x662F; <code>calltree</code> &#x537B;&#x7D66;&#x4E86;&#x6211;&#x5011;&#x4E00;&#x500B;&#x5B8F;&#x89C0;&#x7684;&#x8996;&#x5716;&#x3002;</p>
<p>&#x4E0D;&#x904E;&#x9019;&#x6A23;&#x4E00;&#x500B;&#x8996;&#x5716;&#x53EA;&#x6D89;&#x53CA;&#x5230;&#x7528;&#x6236;&#x7A7A;&#x9593;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x9032;&#x4E00;&#x6B65;&#x7D66;&#x51FA;&#x5167;&#x6838;&#x7A7A;&#x9593;&#x7684;&#x5B8F;&#x89C0;&#x8996;&#x5716;&#xFF0C;&#x90A3;&#x9EBC; <code>strace</code>&#xFF0C;<code>KFT</code> &#x6216;&#x8005; <code>Ftrace</code> &#x5C31;&#x53EF;&#x4EE5;&#x767C;&#x63EE;&#x5B83;&#x5011;&#x7684;&#x4F5C;&#x7528;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x8A72;&#x8996;&#x5716;&#x4E5F;&#x6C92;&#x6709;&#x7D66;&#x51FA;&#x5EAB;&#x4E2D;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x8DDF;&#x8E64;&#x5462;&#xFF1F;&#x9700;&#x8981; <code>ltrace</code> &#x5DE5;&#x5177;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x767C;&#x73FE; <code>calltree</code> &#x50C5;&#x50C5;&#x7D66;&#x51FA;&#x4E86;&#x4E00;&#x500B;&#x7A0B;&#x5E8F;&#x7684;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x8996;&#x5716;&#xFF0C;&#x800C;&#x6C92;&#x6709;&#x544A;&#x8A34;&#x6211;&#x5011;&#x5404;&#x500B;&#x51FD;&#x6578;&#x7684;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x7B49;&#x60C5;&#x6CC1;&#x3002;&#x5982;&#x679C;&#x8981;&#x95DC;&#x6CE8;&#x9019;&#x4E9B;&#x5462;&#xFF1F;&#x6211;&#x5011;&#x6709; <code>gprof</code>&#x3002;</p>
<p><span id="toc_7140_15195_5"></span></p>
<h3 id="%E6%80%A7%E8%83%BD%E6%B8%AC%E8%A9%A6%E5%B7%A5%E5%85%B7-gprof-kprof">&#x6027;&#x80FD;&#x6E2C;&#x8A66;&#x5DE5;&#x5177; gprof &amp; kprof</h3>
<p>&#x53C3;&#x8003;&#x8CC7;&#x6599;<a href="http://www.linuxjournal.com/article/6758" target="_blank">[3]</a>&#x8A73;&#x7D30;&#x4ECB;&#x7D39;&#x4E86;&#x9019;&#x500B;&#x5DE5;&#x5177;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x9019;&#x88E1;&#x50C5;&#x6311;&#x9078;&#x5176;&#x4E2D;&#x4E00;&#x500B;&#x4F8B;&#x5B50;&#x4F86;&#x6F14;&#x793A;&#x3002;<code>gprof</code> &#x662F;&#x4E00;&#x500B;&#x547D;&#x4EE4;&#x884C;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x800C; KDE &#x684C;&#x9762;&#x74B0;&#x5883;&#x4E0B;&#x7684; <code>kprof</code> &#x5247;&#x7D66;&#x51FA;&#x4E86;&#x5716;&#x5F62;&#x5316;&#x7684;&#x8F38;&#x51FA;&#xFF0C;&#x9019;&#x88E1;&#x50C5;&#x6F14;&#x793A;&#x524D;&#x8005;&#x3002;</p>
<p>&#x9996;&#x5148;&#x4F86;&#x770B;&#x4E00;&#x6BB5;&#x4EE3;&#x78BC;&#xFF08;&#x4F86;&#x81EA;&#x8CC7;&#x6599;<a href="http://www.linuxjournal.com/article/6758" target="_blank">[3]</a>&#xFF09;&#xFF0C;&#x7B97; <code>Fibonacci</code> &#x6578;&#x5217;&#x7684;&#xFF0C;</p>
<pre><code>#include &lt;stdio.h&gt;

int fibonacci(int n);

int main (int argc, char **argv)
{
    int fib;
    int n;

    for (n = 0; n &lt;= 42; n++) {
        fib = fibonacci(n);
        printf(&quot;fibonnaci(%d) = %d\n&quot;, n, fib);
    }

    return 0;
}

int fibonacci(int n)
{
    int fib;

    if (n &lt;= 0) {
        fib = 0;
    } else if (n == 1) {
        fib = 1;
    } else {
        fib = fibonacci(n -1) + fibonacci(n - 2);
    }

    return fib;
}
</code></pre><p>&#x901A;&#x904E; <code>calltree</code> &#x770B;&#x770B;&#x9019;&#x6BB5;&#x4EE3;&#x78BC;&#x7684;&#x8996;&#x5716;&#xFF0C;</p>
<pre><code>$ calltree -b -np -m *.c
main:
|   fibonacci
|   |   fibonacci ....
|   printf
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x7A0B;&#x5E8F;&#x4E3B;&#x8981;&#x6D89;&#x53CA;&#x5230;&#x4E00;&#x500B; <code>fibonacci</code> &#x51FD;&#x6578;&#xFF0C;&#x9019;&#x500B;&#x51FD;&#x6578;&#x905E;&#x6B78;&#x8ABF;&#x7528;&#x81EA;&#x5DF1;&#x3002;&#x70BA;&#x4E86;&#x80FD;&#x5920;&#x4F7F;&#x7528; <code>gprof</code>&#xFF0C;&#x9700;&#x8981;&#x7DE8;&#x8B6F;&#x6642;&#x52A0;&#x4E0A; <code>-pg</code> &#x9078;&#x9805;&#xFF0C;&#x8B93; <code>Gcc</code> &#x52A0;&#x5165;&#x76F8;&#x61C9;&#x7684;&#x8ABF;&#x8A66;&#x4FE1;&#x606F;&#x4EE5;&#x4FBF; <code>gprof</code> &#x80FD;&#x5920;&#x7522;&#x751F;&#x51FD;&#x6578;&#x57F7;&#x884C;&#x60C5;&#x6CC1;&#x7684;&#x5831;&#x544A;&#x3002;</p>
<pre><code>$ gcc -pg -o fib fib.c
$ ls
fib  fib.c
</code></pre><p>&#x904B;&#x884C;&#x7A0B;&#x5E8F;&#x4E26;&#x67E5;&#x770B;&#x57F7;&#x884C;&#x6642;&#x9593;&#xFF0C;</p>
<pre><code>$ time ./fib
fibonnaci(0) = 0
fibonnaci(1) = 1
fibonnaci(2) = 1
fibonnaci(3) = 2
...
fibonnaci(41) = 165580141
fibonnaci(42) = 267914296

real    1m25.746s
user    1m9.952s
sys     0m0.072s
$ ls
fib  fib.c  gmon.out
</code></pre><p>&#x4E0A;&#x9762;&#x50C5;&#x50C5;&#x9078;&#x53D6;&#x4E86;&#x90E8;&#x5206;&#x57F7;&#x884C;&#x7D50;&#x679C;&#xFF0C;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x4E86; 1 &#x5206;&#x591A;&#x9418;&#xFF0C;&#x4EE3;&#x78BC;&#x904B;&#x884C;&#x4EE5;&#x5F8C;&#x7522;&#x751F;&#x4E86;&#x4E00;&#x500B; <code>gmon.out</code> &#x6587;&#x4EF6;&#xFF0C;&#x9019;&#x500B;&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x7528;&#x65BC; <code>gprof</code> &#x7522;&#x751F;&#x4E00;&#x500B;&#x76F8;&#x95DC;&#x7684;&#x6027;&#x80FD;&#x5831;&#x544A;&#x3002;</p>
<pre><code>$ gprof  -b ./fib gmon.out 
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls  ms/call  ms/call  name    
 96.04     14.31    14.31       43   332.80   332.80  fibonacci
  4.59     14.99     0.68                             main


                        Call graph


granularity: each sample hit covers 2 byte(s) for 0.07% of 14.99 seconds

index % time    self  children    called     name
                                                 &lt;spontaneous&gt;
[1]    100.0    0.68   14.31                 main [1]
               14.31    0.00      43/43          fibonacci [2]
-----------------------------------------------
                             2269806252             fibonacci [2]
               14.31    0.00      43/43          main [1]
[2]     95.4   14.31    0.00      43+2269806252 fibonacci [2]
                             2269806252             fibonacci [2]
-----------------------------------------------


Index by function name

   [2] fibonacci               [1] main
</code></pre><p>&#x5F9E;&#x9019;&#x4EFD;&#x7D50;&#x679C;&#x4E2D;&#x53EF;&#x89C0;&#x5BDF;&#x5230;&#x7A0B;&#x5E8F;&#x4E2D;&#x6BCF;&#x500B;&#x51FD;&#x6578;&#x7684;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x7B49;&#x60C5;&#x6CC1;&#xFF0C;&#x5F9E;&#x800C;&#x627E;&#x51FA;&#x503C;&#x5F97;&#x4FEE;&#x6539;&#x7684;&#x51FD;&#x6578;&#x3002;&#x5728;&#x5C0D;&#x67D0;&#x4E9B;&#x90E8;&#x5206;&#x4FEE;&#x6539;&#x4E4B;&#x5F8C;&#xFF0C;&#x53EF;&#x4EE5;&#x518D;&#x6B21;&#x6BD4;&#x8F03;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x6642;&#x9593;&#xFF0C;&#x67E5;&#x770B;&#x512A;&#x5316;&#x7D50;&#x679C;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x9019;&#x4EFD;&#x7D50;&#x679C;&#x9084;&#x5305;&#x542B;&#x4E00;&#x500B;&#x7279;&#x5225;&#x6709;&#x7528;&#x7684;&#x6771;&#x897F;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x7A0B;&#x5E8F;&#x7684;&#x52D5;&#x614B;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x60C5;&#x6CC1;&#xFF0C;&#x5373;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x904E;&#x7A0B;&#x4E2D;&#x5BE6;&#x969B;&#x57F7;&#x884C;&#x904E;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x9019;&#x548C; <code>calltree</code> &#x7522;&#x751F;&#x7684;&#x975C;&#x614B;&#x8ABF;&#x7528;&#x6A39;&#x6709;&#x6240;&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x80FD;&#x5920;&#x53CD;&#x61C9;&#x7A0B;&#x5E8F;&#x5728;&#x8A72;&#x6B21;&#x57F7;&#x884C;&#x904E;&#x7A0B;&#x4E2D;&#x7684;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x60C5;&#x6CC1;&#x3002;&#x800C;&#x5982;&#x679C;&#x60F3;&#x53CD;&#x61C9;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x7684;&#x67D0;&#x4E00;&#x6642;&#x523B;&#x8ABF;&#x7528;&#x904E;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x63A1;&#x7528; <code>gdb</code> &#x7684; <code>backtrace</code> &#x547D;&#x4EE4;&#x3002;</p>
<p>&#x985E;&#x4F3C;&#x6E2C;&#x8A66;&#x7D19;&#x7247;&#x539A;&#x5EA6;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;<code>gprof</code> &#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x500B;&#x7D71;&#x8A08;&#x9078;&#x9805;&#xFF0C;&#x7528;&#x65BC;&#x5C0D;&#x7A0B;&#x5E8F;&#x7684;&#x591A;&#x6B21;&#x904B;&#x884C;&#x7D50;&#x679C;&#x9032;&#x884C;&#x7D71;&#x8A08;&#x3002;&#x53E6;&#x5916;&#xFF0C;<code>gprof</code> &#x6709;&#x4E00;&#x500B; KDE &#x4E0B;&#x5716;&#x5F62;&#x5316;&#x63A5;&#x53E3; <code>kprof</code>&#xFF0C;&#x9019;&#x5169;&#x90E8;&#x5206;&#x8ACB;&#x53C3;&#x8003;&#x8CC7;&#x6599;<a href="http://www.linuxjournal.com/article/6758" target="_blank">[3]</a>&#x3002;</p>
<p>&#x5C0D;&#x65BC;&#x975E; KDE &#x74B0;&#x5883;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <a href="https://code.google.com/p/jrfonseca/wiki/Gprof2Dot" target="_blank">Gprof2Dot</a> &#x628A; <code>gprof</code> &#x8F38;&#x51FA;&#x8F49;&#x63DB;&#x6210;&#x5716;&#x5F62;&#x5316;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x95DC;&#x65BC; <code>dot</code> &#x683C;&#x5F0F;&#x7684;&#x8F38;&#x51FA;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x901A;&#x904E; <code>dot</code> &#x547D;&#x4EE4;&#x628A;&#x7D50;&#x679C;&#x8F49;&#x6210; <code>jpg</code> &#x7B49;&#x683C;&#x5F0F;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<pre><code>$ dot -Tjpg test.dot -o test.jp
</code></pre><p><code>gprof</code> &#x96D6;&#x7136;&#x7D66;&#x51FA;&#x4E86;&#x51FD;&#x6578;&#x7D1A;&#x5225;&#x7684;&#x57F7;&#x884C;&#x60C5;&#x6CC1;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x60F3;&#x95DC;&#x5FC3;&#x5177;&#x9AD4;&#x54EA;&#x4E9B;&#x689D;&#x4EF6;&#x5206;&#x652F;&#x88AB;&#x57F7;&#x884C;&#x5230;&#xFF0C;&#x54EA;&#x4E9B;&#x8A9E;&#x53E5;&#x6C92;&#x6709;&#x88AB;&#x57F7;&#x884C;&#xFF0C;&#x8A72;&#x600E;&#x9EBC;&#x8FA6;&#xFF1F;</p>
<p><span id="toc_7140_15195_6"></span></p>
<h3 id="%E4%BB%A3%E7%A2%BC%E8%A6%86%E8%93%8B%E7%8E%87%E6%B8%AC%E8%A9%A6-gcov-ggcov">&#x4EE3;&#x78BC;&#x8986;&#x84CB;&#x7387;&#x6E2C;&#x8A66; gcov &amp; ggcov</h3>
<p>&#x5982;&#x679C;&#x8981;&#x4F7F;&#x7528; <code>gcov</code>&#xFF0C;&#x5728;&#x7DE8;&#x8B6F;&#x6642;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x9019;&#x5169;&#x500B;&#x9078;&#x9805; <code>-fprofile-arcs -ftest-coverage</code>&#xFF0C;&#x9019;&#x88E1;&#x76F4;&#x63A5;&#x7528;&#x4E4B;&#x524D;&#x7684; <code>fib.c</code> &#x505A;&#x6F14;&#x793A;&#x3002;</p>
<pre><code>$ ls
fib.c
$ gcc -fprofile-arcs -ftest-coverage -o fib fib.c
$ ls
fib  fib.c  fib.gcno
</code></pre><p>&#x904B;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x4E26;&#x901A;&#x904E; <code>gcov</code> &#x5206;&#x6790;&#x4EE3;&#x78BC;&#x7684;&#x8986;&#x84CB;&#x5EA6;&#xFF1A;</p>
<pre><code>$ ./fib
$ gcov fib.c
File &apos;fib.c&apos;
Lines executed:100.00% of 12
fib.c:creating &apos;fib.c.gcov&apos;
</code></pre><p>12 &#x884C;&#x4EE3;&#x78BC; 100% &#x88AB;&#x57F7;&#x884C;&#x5230;&#xFF0C;&#x518D;&#x67E5;&#x770B;&#x5206;&#x652F;&#x60C5;&#x6CC1;&#xFF0C;</p>
<pre><code>$ gcov -b fib.c
File &apos;fib.c&apos;
Lines executed:100.00% of 12
Branches executed:100.00% of 6
Taken at least once:100.00% of 6
Calls executed:100.00% of 4
fib.c:creating &apos;fib.c.gcov&apos;
</code></pre><p>&#x767C;&#x73FE;&#x6240;&#x6709;&#x51FD;&#x6578;&#xFF0C;&#x689D;&#x4EF6;&#x5206;&#x652F;&#x548C;&#x8A9E;&#x53E5;&#x90FD;&#x88AB;&#x57F7;&#x884C;&#x5230;&#xFF0C;&#x8AAA;&#x660E;&#x4EE3;&#x78BC;&#x7684;&#x8986;&#x84CB;&#x7387;&#x5F88;&#x9AD8;&#xFF0C;&#x4E0D;&#x904E;&#x8CC7;&#x6599;<a href="http://www.linuxjournal.com/article/6758" target="_blank">[3]</a> <code>gprof</code> &#x7684;&#x6F14;&#x793A;&#x986F;&#x793A;&#x4EE3;&#x78BC;&#x7684;&#x8986;&#x84CB;&#x7387;&#x9AD8;&#x4E26;&#x4E0D;&#x4E00;&#x5B9A;&#x8AAA;&#x660E;&#x4EE3;&#x78BC;&#x7684;&#x6027;&#x80FD;&#x5C31;&#x597D;&#xFF0C;&#x56E0;&#x70BA;&#x90A3;&#x4E9B;&#x88AB;&#x8986;&#x84CB;&#x5230;&#x7684;&#x4EE3;&#x78BC;&#x53EF;&#x80FD;&#x80FD;&#x5920;&#x88AB;&#x512A;&#x5316;&#x6210;&#x6027;&#x80FD;&#x66F4;&#x9AD8;&#x7684;&#x4EE3;&#x78BC;&#x3002;&#x90A3;&#x5230;&#x5E95;&#x54EA;&#x4E9B;&#x4EE3;&#x78BC;&#x503C;&#x5F97;&#x88AB;&#x512A;&#x5316;&#x5462;&#xFF1F;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x6700;&#x591A;&#x7684;&#xFF0C;&#x53E6;&#x5916;&#xFF0C;&#x6709;&#x4E9B;&#x5206;&#x652F;&#x96D6;&#x7136;&#x90FD;&#x8986;&#x84CB;&#x5230;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x9019;&#x500B;&#x5206;&#x652F;&#x7684;&#x4F4D;&#x7F6E;&#x53EF;&#x80FD;&#x4E26;&#x4E0D;&#x662F;&#x7406;&#x60F3;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x500B;&#x5206;&#x652F;&#x7684;&#x5167;&#x5BB9;&#x88AB;&#x57F7;&#x884C;&#x7684;&#x6B21;&#x6578;&#x5F88;&#x591A;&#xFF0C;&#x90A3;&#x9EBC;&#x628A;&#x5B83;&#x4F5C;&#x70BA;&#x6700;&#x5F8C;&#x4E00;&#x500B;&#x5206;&#x652F;&#x7684;&#x8A71;&#x5C31;&#x6703;&#x6D6A;&#x8CBB;&#x5F88;&#x591A;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x6BD4;&#x8F03;&#x6642;&#x9593;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x904E;&#x8986;&#x84CB;&#x7387;&#x6E2C;&#x8A66;&#xFF0C;&#x53EF;&#x4EE5;&#x5617;&#x8A66;&#x8457;&#x5254;&#x9664;&#x90A3;&#x4E9B;&#x5F9E;&#x672A;&#x57F7;&#x884C;&#x904E;&#x7684;&#x4EE3;&#x78BC;&#x6216;&#x8005;&#x628A;&#x90A3;&#x4E9B;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x8F03;&#x591A;&#x7684;&#x5206;&#x652F;&#x79FB;&#x52D5;&#x5230;&#x8F03;&#x65E9;&#x7684;&#x689D;&#x4EF6;&#x5206;&#x652F;&#x88E1;&#x982D;&#x3002;&#x901A;&#x904E;&#x6027;&#x80FD;&#x6E2C;&#x8A66;&#xFF0C;&#x53EF;&#x4EE5;&#x627E;&#x51FA;&#x90A3;&#x4E9B;&#x503C;&#x5F97;&#x512A;&#x5316;&#x7684;&#x51FD;&#x6578;&#x3001;&#x5206;&#x652F;&#x6216;&#x8005;&#x662F;&#x8A9E;&#x53E5;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528; <code>-fprofile-arcs -ftest-coverage</code> &#x53C3;&#x6578;&#x7DE8;&#x8B6F;&#x5B8C;&#x4EE3;&#x78BC;&#xFF0C;&#x53EF;&#x4EE5;&#x63A5;&#x8457;&#x7528; <code>-fbranch-probabilities</code> &#x53C3;&#x6578;&#x5C0D;&#x4EE3;&#x78BC;&#x9032;&#x884C;&#x7DE8;&#x8B6F;&#xFF0C;&#x9019;&#x6A23;&#xFF0C;&#x7DE8;&#x8B6F;&#x5668;&#x5C31;&#x53EF;&#x4EE5;&#x5C0D;&#x6839;&#x64DA;&#x4EE3;&#x78BC;&#x7684;&#x5206;&#x652F;&#x6E2C;&#x8A66;&#x60C5;&#x6CC1;&#x9032;&#x884C;&#x512A;&#x5316;&#x3002;</p>
<pre><code>$ wc -c fib
16333 fib
$ ls fib.gcda  #&#x78BA;&#x4FDD;fib.gcda&#x5DF2;&#x7D93;&#x751F;&#x6210;&#xFF0C;&#x9019;&#x500B;&#x662F;&#x904B;&#x884C;fib&#x5F8C;&#x7684;&#x7D50;&#x679C;
fib.gcda
$ gcc -fbranch-probabilities -o fib fib.c #&#x518D;&#x6B21;&#x904B;&#x884C;
$ wc -c fib
6604 fib
$ time ./fib
...
real    0m21.686s
user    0m18.477s
sys     0m0.008s
</code></pre><p>&#x53EF;&#x898B;&#x4EE3;&#x78BC;&#x91CF;&#x6E1B;&#x5C11;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x57F7;&#x884C;&#x6548;&#x7387;&#x6703;&#x6709;&#x6240;&#x63D0;&#x9AD8;&#xFF0C;&#x7576;&#x7136;&#xFF0C;&#x9019;&#x500B;&#x4EE3;&#x78BC;&#x6548;&#x7387;&#x7684;&#x63D0;&#x9AD8;&#x53EF;&#x80FD;&#x9084;&#x8DDF;&#x5176;&#x4ED6;&#x56E0;&#x7D20;&#x6709;&#x95DC;&#xFF0C;&#x6BD4;&#x5982; <code>Gcc</code> &#x9084;&#x512A;&#x5316;&#x4E86;&#x4E00;&#x4E9B;&#x8DDF;&#x5E73;&#x81FA;&#x76F8;&#x95DC;&#x7684;&#x6307;&#x4EE4;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60F3;&#x770B;&#x770B;&#x4EE3;&#x78BC;&#x4E2D;&#x5404;&#x884C;&#x88AB;&#x57F7;&#x884C;&#x7684;&#x60C5;&#x6CC1;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x770B; <code>fib.c.gcov</code> &#x6587;&#x4EF6;&#x3002;&#x9019;&#x500B;&#x6587;&#x4EF6;&#x7684;&#x5404;&#x5217;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x3001;&#x884C;&#x865F;&#x548C;&#x8A72;&#x884C;&#x7684;&#x6E90;&#x4EE3;&#x78BC;&#x3002;&#x6B21;&#x6578;&#x6709;&#x4E09;&#x7A2E;&#x60C5;&#x6CC1;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x76F4;&#x6C92;&#x6709;&#x57F7;&#x884C;&#xFF0C;&#x90A3;&#x9EBC;&#x7528; <code>####</code> &#x8868;&#x793A;&#xFF1B;&#x5982;&#x679C;&#x8A72;&#x884C;&#x662F;&#x8A3B;&#x91CB;&#x3001;&#x51FD;&#x6578;&#x8072;&#x660E;&#x7B49;&#xFF0C;&#x7528; <code>-</code> &#x8868;&#x793A;&#xFF1B;&#x5982;&#x679C;&#x662F;&#x7D14;&#x7CB9;&#x7684;&#x4EE3;&#x78BC;&#x884C;&#xFF0C;&#x90A3;&#x9EBC;&#x7528;&#x57F7;&#x884C;&#x6B21;&#x6578;&#x8868;&#x793A;&#x3002;&#x9019;&#x6A23;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5206;&#x6790;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x57F7;&#x884C;&#x60C5;&#x6CC1;&#x3002;</p>
<p><code>gcov</code> &#x4E5F;&#x6709;&#x4E00;&#x500B;&#x5716;&#x5F62;&#x5316;&#x63A5;&#x53E3; <code>ggcov</code>&#xFF0C;&#x662F;&#x57FA;&#x65BC; <code>gtk+</code> &#x7684;&#xFF0C;&#x9069;&#x5408; Gnome &#x684C;&#x9762;&#x7684;&#x7528;&#x6236;&#x3002;</p>
<p>&#x73FE;&#x5728;&#x90FD;&#x5DF2;&#x7D93;&#x95DC;&#x6CE8;&#x5230;&#x4EE3;&#x78BC;&#x884C;&#x4E86;&#xFF0C;&#x5BE6;&#x969B;&#x4E0A;&#x512A;&#x5316;&#x4EE3;&#x78BC;&#x7684;&#x524D;&#x63D0;&#x662F;&#x4FDD;&#x8B49;&#x4EE3;&#x78BC;&#x7684;&#x6B63;&#x78BA;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x4EE3;&#x78BC;&#x9084;&#x6709;&#x5F88;&#x591A; bug&#xFF0C;&#x90A3;&#x9EBC;&#x5148;&#x8981; debug&#x3002;&#x4E0D;&#x904E;&#x4E0B;&#x9762;&#x7684;&#x9019;&#x4E9B; &quot;bug&quot; &#x7528;&#x666E;&#x901A;&#x7684;&#x5DE5;&#x5177;&#x78BA;&#x5BE6;&#x4E0D;&#x592A;&#x65B9;&#x4FBF;&#xFF0C;&#x96D6;&#x7136;&#x53EF;&#x80FD;&#xFF0C;&#x4E0D;&#x904E;&#x9019;&#x88E1;&#x9084;&#x662F;&#x628A;&#x5B83;&#x5011;&#x6B78;&#x7D50;&#x70BA;&#x6E2C;&#x8A66;&#x7684;&#x5167;&#x5BB9;&#xFF0C;&#x4E26;&#x4E14;&#x9019;&#x88E1;&#x525B;&#x597D;&#x627F;&#x63A5;&#x4E0A; <code>gcov</code> &#x90E8;&#x5206;&#xFF0C;<code>gcov</code> &#x80FD;&#x5920;&#x6E2C;&#x8A66;&#x5230;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x4EE3;&#x78BC;&#x8986;&#x84CB;&#x60C5;&#x6CC1;&#xFF0C;&#x800C;&#x7121;&#x8AD6;&#x662F;&#x5167;&#x5B58;&#x8A2A;&#x554F;&#x8D8A;&#x754C;&#x3001;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x9084;&#x662F;&#x5167;&#x5B58;&#x6D29;&#x9732;&#xFF0C;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x767C;&#x751F;&#x5728;&#x5177;&#x9AD4;&#x7684;&#x4EE3;&#x78BC;&#x884C;&#x4E0A;&#x7684;&#x3002;</p>
<p><span id="toc_7140_15195_7"></span></p>
<h3 id="%E5%85%A7%E5%AD%98%E8%A8%AA%E5%95%8F%E8%B6%8A%E7%95%8C-catchsegv-libsegfault-so">&#x5167;&#x5B58;&#x8A2A;&#x554F;&#x8D8A;&#x754C; catchsegv, libSegFault.so</h3>
<p>&quot;Segmentation fault&quot; &#x662F;&#x5F88;&#x982D;&#x75DB;&#x7684;&#x4E00;&#x500B;&#x554F;&#x984C;&#xFF0C;&#x4F30;&#x8A08;&#x201C;&#x7CFE;&#x7E8F;&#x201D;&#x904E;&#x5F88;&#x591A;&#x4EBA;&#x3002;&#x9019;&#x88E1;&#x50C5;&#x50C5;&#x6F14;&#x793A;&#x901A;&#x904E; <code>catchsegv</code> &#x8173;&#x672C;&#x6E2C;&#x8A66;&#x6BB5;&#x932F;&#x8AA4;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x898B;&#x5F8C;&#x9762;&#x76F8;&#x95DC;&#x8CC7;&#x6599;&#x3002;</p>
<p><code>catchsegv</code> &#x5229;&#x7528;&#x7CFB;&#x7D71;&#x52D5;&#x614B;&#x93C8;&#x63A5;&#x7684; <code>PRELOAD</code> &#x6A5F;&#x5236;&#xFF08;&#x8ACB;&#x53C3;&#x8003;<code>man ld-linux</code>&#xFF09;&#xFF0C;&#x628A;&#x5EAB; <code>/lib/libSegFault.so</code> &#x63D0;&#x524D; load &#x5230;&#x5167;&#x5B58;&#x4E2D;&#xFF0C;&#x7136;&#x5F8C;&#x901A;&#x904E;&#x5B83;&#x6AA2;&#x67E5;&#x7A0B;&#x5E8F;&#x904B;&#x884C;&#x904E;&#x7A0B;&#x4E2D;&#x7684;&#x6BB5;&#x932F;&#x8AA4;&#x3002;</p>
<pre><code>$ cat test.c
#include &lt;stdio.h&gt;

int main(void)
{
    char str[10];

        sprintf(str, &quot;%s&quot;, 111);

        printf(&quot;str = %s\n&quot;, str);
        return 0;
}
$ make test
$ LD_PRELOAD=/lib/libSegFault.so ./test  #&#x7B49;&#x540C;&#x65BC;catchsegv ./test
*** Segmentation fault
Register dump:

 EAX: 0000006f   EBX: b7eecff4   ECX: 00000003   EDX: 0000006f
 ESI: 0000006f   EDI: 0804851c   EBP: bff9a8a4   ESP: bff9a27c

 EIP: b7e1755b   EFLAGS: 00010206

 CS: 0073   DS: 007b   ES: 007b   FS: 0000   GS: 0033   SS: 007b

 Trap: 0000000e   Error: 00000004   OldMask: 00000000
 ESP/signal: bff9a27c   CR2: 0000006f

Backtrace:
/lib/libSegFault.so[0xb7f0604f]
[0xffffe420]
/lib/tls/i686/cmov/libc.so.6(vsprintf+0x8c)[0xb7e0233c]
/lib/tls/i686/cmov/libc.so.6(sprintf+0x2e)[0xb7ded9be]
./test[0x804842b]
/lib/tls/i686/cmov/libc.so.6(__libc_start_main+0xe0)[0xb7dbd050]
./test[0x8048391]
...
</code></pre><p>&#x5F9E;&#x7D50;&#x679C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x4EE3;&#x78BC;&#x7684; <code>sprintf</code> &#x6709;&#x554F;&#x984C;&#x3002;&#x7D93;&#x904E;&#x6AA2;&#x67E5;&#x767C;&#x73FE;&#x5B83;&#x628A;&#x6574;&#x6578;&#x7576;&#x5B57;&#x7B26;&#x4E32;&#x8F38;&#x51FA;&#xFF0C;&#x5C0D;&#x65BC;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8F38;&#x51FA;&#xFF0C;&#x9700;&#x8981;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5730;&#x5740;&#x4F5C;&#x70BA;&#x53C3;&#x6578;&#xFF0C;&#x800C;&#x9019;&#x88E1;&#x7684; <code>111</code> &#x5247;&#x525B;&#x597D;&#x88AB;&#x89E3;&#x91CB;&#x6210;&#x4E86;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x56E0;&#x6B64; <code>sprintf</code> &#x8A66;&#x5716;&#x8A2A;&#x554F; <code>111</code> &#x9019;&#x500B;&#x5730;&#x5740;&#xFF0C;&#x5F9E;&#x800C;&#x767C;&#x751F;&#x4E86;&#x975E;&#x6CD5;&#x8A2A;&#x554F;&#x5167;&#x5B58;&#x7684;&#x60C5;&#x6CC1;&#xFF0C;&#x51FA;&#x73FE; &#x201C;Segmentation Fault&#x201D;&#x3002;</p>
<p><span id="toc_7140_15195_8"></span></p>
<h3 id="%E7%B7%A9%E8%A1%9D%E5%8D%80%E6%BA%A2%E5%87%BA-libsafe-so">&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA; libsafe.so</h3>
<p>&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x662F;&#x5806;&#x68E7;&#x6EA2;&#x51FA;&#xFF08;Stack Smashing&#xFF09;&#xFF0C;&#x901A;&#x5E38;&#x767C;&#x751F;&#x5728;&#x5C0D;&#x51FD;&#x6578;&#x5167;&#x7684;&#x5C40;&#x90E8;&#x8B8A;&#x91CF;&#x9032;&#x884C;&#x8CE6;&#x503C;&#x64CD;&#x4F5C;&#x6642;&#xFF0C;&#x8D85;&#x51FA;&#x4E86;&#x8A72;&#x8B8A;&#x91CF;&#x7684;&#x5B57;&#x7BC0;&#x9577;&#x5EA6;&#x800C;&#x5F15;&#x8D77;&#x5C0D;&#x68E7;&#x5167;&#x539F;&#x6709;&#x6578;&#x64DA;&#xFF08;&#x6BD4;&#x5982; eip&#xFF0C;ebp &#x7B49;&#xFF09;&#x7684;&#x8986;&#x84CB;&#xFF0C;&#x5F9E;&#x800C;&#x5F15;&#x767C;&#x5167;&#x5B58;&#x8A2A;&#x554F;&#x8D8A;&#x754C;&#xFF0C;&#x751A;&#x81F3;&#x57F7;&#x884C;&#x975E;&#x6CD5;&#x4EE3;&#x78BC;&#xFF0C;&#x5C0E;&#x81F4;&#x7CFB;&#x7D71;&#x5D29;&#x6F70;&#x3002;&#x95DC;&#x65BC;&#x7DE9;&#x885D;&#x5340;&#x7684;&#x8A73;&#x7D30;&#x539F;&#x7406;&#x548C;&#x5BE6;&#x4F8B;&#x5206;&#x6790;&#x898B;<a href="02-chapter5.html">&#x300A;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x8207;&#x6CE8;&#x5165;&#x5206;&#x6790;&#x300B;</a>&#x3002;&#x9019;&#x88E1;&#x50C5;&#x50C5;&#x6F14;&#x793A;&#x8A72;&#x8CC7;&#x6599;&#x4E2D;&#x63D0;&#x5230;&#x7684;&#x4E00;&#x7A2E;&#x7528;&#x65BC;&#x6AA2;&#x67E5;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x540C;&#x6A23;&#x63A1;&#x7528;&#x52D5;&#x614B;&#x93C8;&#x63A5;&#x7684; <code>PRELOAD</code> &#x6A5F;&#x5236;&#x63D0;&#x524D;&#x88DD;&#x8F09;&#x4E00;&#x500B;&#x540D;&#x53EB; <code>libsafe.so</code> &#x7684;&#x5EAB;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E;<a href="http://www.sfr-fresh.com/linux/misc/libsafe-2.0-16.tgz" target="_blank">&#x9019;&#x88E1;</a>&#x7372;&#x53D6;&#x5B83;&#xFF0C;&#x4E0B;&#x8F09;&#x5F8C;&#xFF0C;&#x518D;&#x89E3;&#x58D3;&#xFF0C;&#x7DE8;&#x8B6F;&#xFF0C;&#x5F97;&#x5230; <code>libsafe.so</code>&#xFF0C;</p>
<p>&#x4E0B;&#x9762;&#xFF0C;&#x6F14;&#x793A;&#x4E00;&#x500B;&#x975E;&#x5E38;&#x7C21;&#x55AE;&#x7684;&#xFF0C;&#x4F46;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x7684;&#x4EE3;&#x78BC;&#xFF0C;&#x4E26;&#x6F14;&#x793A; <code>libsafe.so</code> &#x7684;&#x7528;&#x6CD5;&#x3002;</p>
<pre><code>$ cat test.c
$ make test
$ LD_PRELOAD=/path/to/libsafe.so ./test ABCDEFGHIJKLMN
ABCDEFGHIJKLMN
*** stack smashing detected ***: ./test terminated
Aborted (core dumped)
</code></pre><p>&#x8CC7;&#x6599;<a href="http://www.ibm.com/developerworks/linux/library/l-debug/" target="_blank">[7]</a>&#x5206;&#x6790;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x80FD;&#x5920;&#x5C0D;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x9032;&#x884C;&#x6709;&#x6548;&#x7684;&#x8655;&#x7406;&#xFF0C;&#x53EF;&#x80FD;&#x6703;&#x5B58;&#x5728;&#x5F88;&#x591A;&#x6F5B;&#x5728;&#x7684;&#x5371;&#x96AA;&#x3002;&#x96D6;&#x7136; <code>libsafe.so</code> &#x63A1;&#x7528;&#x51FD;&#x6578;&#x66FF;&#x63DB;&#x7684;&#x65B9;&#x6CD5;&#x80FD;&#x5920;&#x9032;&#x884C;&#x5C0D;&#x9019;&#x985E; Stack Smashing &#x9032;&#x884C;&#x4E00;&#x5B9A;&#x7684;&#x4FDD;&#x8B77;&#xFF0C;&#x4F46;&#x662F;&#x7121;&#x6CD5;&#x6839;&#x672C;&#x89E3;&#x6C7A;&#x554F;&#x984C;&#xFF0C;alert7 &#x5927;&#x8766;&#x5728;&#x8CC7;&#x6599;<a href="http://www.xfocus.net/articles/200208/423.html" target="_blank">[10]</a>&#x4E2D;&#x63D0;&#x51FA;&#x4E86;&#x7A81;&#x7834;&#x5B83;&#x7684;&#x8FA6;&#x6CD5;&#xFF0C;&#x8CC7;&#x6599;<a href="http://www.xfocus.net/articles/200103/78.html" target="_blank">11</a>11]&#x63D0;&#x51FA;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x7A2E;&#x4FDD;&#x8B77;&#x6A5F;&#x5236;&#x3002;</p>
<p><span id="toc_7140_15195_9"></span></p>
<h3 id="%E5%85%A7%E5%AD%98%E6%B4%A9%E9%9C%B2-memwatch-valgrind-mtrace">&#x5167;&#x5B58;&#x6D29;&#x9732; Memwatch, Valgrind, mtrace</h3>
<p>&#x5806;&#x68E7;&#x901A;&#x5E38;&#x6703;&#x88AB;&#x5F04;&#x5728;&#x4E00;&#x8D77;&#x53EB;&#xFF0C;&#x4E0D;&#x904E;&#x9019;&#x5169;&#x500B;&#x540D;&#x8A5E;&#x537B;&#x662F;&#x6307;&#x9032;&#x7A0B;&#x7684;&#x5167;&#x5B58;&#x6620;&#x50CF;&#x4E2D;&#x7684;&#x5169;&#x500B;&#x4E0D;&#x540C;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x68E7;&#xFF08;Stack&#xFF09;&#x7528;&#x65BC;&#x51FD;&#x6578;&#x7684;&#x53C3;&#x6578;&#x50B3;&#x905E;&#x3001;&#x5C40;&#x90E8;&#x8B8A;&#x91CF;&#x7684;&#x5B58;&#x5132;&#x7B49;&#xFF0C;&#x662F;&#x7CFB;&#x7D71;&#x81EA;&#x52D5;&#x5206;&#x914D;&#x548C;&#x56DE;&#x6536;&#x7684;&#xFF1B;&#x800C;&#x5806;&#xFF08;heap&#xFF09;&#x5247;&#x662F;&#x7528;&#x6236;&#x901A;&#x904E; <code>malloc</code> &#x7B49;&#x65B9;&#x5F0F;&#x7533;&#x8ACB;&#x800C;&#x4E14;&#x9700;&#x8981;&#x7528;&#x6236;&#x81EA;&#x5DF1;&#x901A;&#x904E; <code>free</code> &#x91CB;&#x653E;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x7533;&#x8ACB;&#x7684;&#x5167;&#x5B58;&#x6C92;&#x6709;&#x91CB;&#x653E;&#xFF0C;&#x90A3;&#x9EBC;&#x5C07;&#x5C0E;&#x81F4;&#x5167;&#x5B58;&#x6D29;&#x9732;&#xFF0C;&#x9032;&#x800C;&#x53EF;&#x80FD;&#x5C0E;&#x81F4;&#x5806;&#x7684;&#x7A7A;&#x9593;&#x88AB;&#x7528;&#x76E1;&#xFF1B;&#x800C;&#x5982;&#x679C;&#x5DF2;&#x7D93;&#x91CB;&#x653E;&#x7684;&#x5167;&#x5B58;&#x518D;&#x6B21;&#x88AB;&#x91CB;&#x653E;&#xFF08;double-free&#xFF09;&#x5247;&#x4E5F;&#x6703;&#x51FA;&#x73FE;&#x975E;&#x6CD5;&#x64CD;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x8981;&#x771F;&#x6B63;&#x7406;&#x89E3;&#x5806;&#x548C;&#x68E7;&#x7684;&#x5340;&#x5225;&#xFF0C;&#x9700;&#x8981;&#x7406;&#x89E3;&#x9032;&#x7A0B;&#x7684;&#x5167;&#x5B58;&#x6620;&#x50CF;&#xFF0C;&#x8ACB;&#x53C3;&#x8003;<a href="02-chapter5.html">&#x300A;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x8207;&#x6CE8;&#x5165;&#x5206;&#x6790;&#x300B;</a></p>
<p>&#x9019;&#x88E1;&#x6F14;&#x793A;&#x901A;&#x904E; <code>Memwatch</code> &#x4F86;&#x6AA2;&#x6E2C;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x5167;&#x5B58;&#x6D29;&#x9732;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E;<a href="http://www.linkdata.se/sourcecode.html" target="_blank">&#x9019;&#x88E1;</a>&#x4E0B;&#x8F09;&#x5230;&#x9019;&#x500B;&#x5DE5;&#x5177;&#x3002;
&#x4F7F;&#x7528;&#x9019;&#x500B;&#x5DE5;&#x5177;&#x7684;&#x65B9;&#x5F0F;&#x5F88;&#x7C21;&#x55AE;&#xFF0C;&#x53EA;&#x8981;&#x628A;&#x5B83;&#x93C8;&#x63A5;&#xFF08;ld&#xFF09;&#x5230;&#x53EF;&#x57F7;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x53BB;&#xFF0C;&#x4E26;&#x5728;&#x7DE8;&#x8B6F;&#x6642;&#x52A0;&#x4E0A;&#x5169;&#x500B;&#x5B8F;&#x958B;&#x95DC;<code>-DMEMWATCH -DMW_STDIO</code>&#x3002;&#x9019;&#x88E1;&#x6F14;&#x793A;&#x4E00;&#x500B;&#x7C21;&#x55AE;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<pre><code>$ cat test.c 
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &quot;memwatch.h&quot;

int main(void)
{
    char *ptr1;
    char *ptr2;

    ptr1 = malloc(512);
    ptr2 = malloc(512);

    ptr2 = ptr1;
    free(ptr2);
    free(ptr1);
}
$ gcc -DMEMWATCH -DMW_STDIO test.c memwatch.c -o test
$ cat memwatch.log
============= MEMWATCH 2.71 Copyright (C) 1992-1999 Johan Lindh =============

Started at Sat Mar  1 07:34:33 2008

Modes: __STDC__ 32-bit mwDWORD==(unsigned long)
mwROUNDALLOC==4 sizeof(mwData)==32 mwDataSize==32

double-free: &lt;4&gt; test.c(15), 0x80517e4 was freed from test.c(14)

Stopped at Sat Mar  1 07:34:33 2008

unfreed: &lt;2&gt; test.c(11), 512 bytes at 0x8051a14         {FE FE FE FE FE FE FE FE FE FE FE FE FE FE FE FE ................}

Memory usage statistics (global):
 N)umber of allocations made: 2
 L)argest memory usage      : 1024
 T)otal of all alloc() calls: 1024
 U)nfreed bytes totals      : 512
</code></pre><p>&#x901A;&#x904E;&#x6E2C;&#x8A66;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;&#x4E00;&#x500B; 512 &#x5B57;&#x7BC0;&#x7684;&#x7A7A;&#x9593;&#x6C92;&#x6709;&#x88AB;&#x91CB;&#x653E;&#xFF0C;&#x800C;&#x53E6;&#x5916; 512 &#x5B57;&#x7BC0;&#x7A7A;&#x9593;&#x537B;&#x88AB;&#x9023;&#x7E8C;&#x91CB;&#x653E;&#x5169;&#x6B21;&#xFF08;double-free&#xFF09;&#x3002;<code>Valgrind</code> &#x548C; <code>mtrace</code> &#x4E5F;&#x53EF;&#x4EE5;&#x505A;&#x985E;&#x4F3C;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x8ACB;&#x53C3;&#x8003;&#x8CC7;&#x6599;<a href="http://www.faqs.org/docs/Linux-HOWTO/Valgrind-HOWTO.html" target="_blank">[4]</a>&#xFF0C;<a href="http://www.cprogramming.com/debugging/valgrind.html" target="_blank">[5]</a>&#x548C; <code>mtrace</code> &#x7684;&#x624B;&#x518A;&#x3002;</p>
<p><span id="toc_7140_15195_10"></span></p>
<h2 id="%E4%BB%A3%E7%A2%BC%E8%AA%BF%E8%A9%A6">&#x4EE3;&#x78BC;&#x8ABF;&#x8A66;</h2>
<p>&#x8ABF;&#x8A66;&#x7684;&#x65B9;&#x6CD5;&#x5F88;&#x591A;&#xFF0C;&#x8ABF;&#x8A66;&#x5F80;&#x5F80;&#x8981;&#x8DDF;&#x8E64;&#x4EE3;&#x78BC;&#x7684;&#x904B;&#x884C;&#x72C0;&#x614B;&#xFF0C;<code>printf</code> &#x662F;&#x6700;&#x57FA;&#x672C;&#x7684;&#x8FA6;&#x6CD5;&#xFF0C;&#x7136;&#x5F8C;&#x5462;&#xFF1F;&#x975C;&#x614B;&#x8ABF;&#x8A66;&#x65B9;&#x6CD5;&#x6709;&#x54EA;&#x4E9B;&#xFF0C;&#x975E;&#x4EA4;&#x4E92;&#x7684;&#x5462;&#xFF1F;&#x975E;&#x5BE6;&#x6642;&#x7684;&#x6709;&#x54EA;&#x4E9B;&#xFF1F;&#x5BE6;&#x6642;&#x7684;&#x5462;&#xFF1F;&#x7528;&#x65BC;&#x8ABF;&#x8A66;&#x5167;&#x6838;&#x7684;&#x65B9;&#x6CD5;&#x6709;&#x54EA;&#x4E9B;&#xFF1F;&#x6709;&#x54EA;&#x4E9B;&#x53EF;&#x4EE5;&#x7528;&#x4F86;&#x8ABF;&#x8A66;&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#x5462;&#xFF1F;</p>
<p><span id="toc_7140_15195_11"></span></p>
<h3 id="%E9%9D%9C%E6%85%8B%E8%AA%BF%E8%A9%A6%EF%BC%9Aprintf-gcc-d%EF%BC%88%E6%89%93%E5%8D%B0%E7%A8%8B%E5%BA%8F%E4%B8%AD%E7%9A%84%E8%AE%8A%E9%87%8F%EF%BC%89">&#x975C;&#x614B;&#x8ABF;&#x8A66;&#xFF1A;printf + gcc -D&#xFF08;&#x6253;&#x5370;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x8B8A;&#x91CF;&#xFF09;</h3>
<p>&#x5229;&#x7528; <code>Gcc</code> &#x7684;&#x5B8F;&#x5B9A;&#x7FA9;&#x958B;&#x95DC;&#xFF08;<code>-D</code>&#xFF09;&#x548C; <code>printf</code> &#x51FD;&#x6578;&#x53EF;&#x4EE5;&#x8DDF;&#x8E64;&#x7A0B;&#x5E8F;&#x4E2D;&#x67D0;&#x500B;&#x4F4D;&#x7F6E;&#x7684;&#x72C0;&#x614B;&#xFF0C;&#x9019;&#x500B;&#x72C0;&#x614B;&#x5305;&#x62EC;&#x7576;&#x524D;&#x4E00;&#x4E9B;&#x8B8A;&#x91CF;&#x548C;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x503C;&#x3002;&#x8ABF;&#x8A66;&#x6642;&#x9700;&#x8981;&#x7528; <code>-D</code> &#x958B;&#x95DC;&#x9032;&#x884C;&#x7DE8;&#x8B6F;&#xFF0C;&#x5728;&#x6B63;&#x5F0F;&#x767C;&#x4F48;&#x7A0B;&#x5E8F;&#x6642;&#x5247;&#x53EF;&#x628A; <code>-D</code> &#x958B;&#x95DC;&#x53BB;&#x6389;&#x3002;&#x9019;&#x6A23;&#x505A;&#x6BD4;&#x55AE;&#x7D14;&#x7528; <code>printf</code> &#x65B9;&#x4FBF;&#x5F88;&#x591A;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x6E05;&#x7406;&#x8ABF;&#x8A66;&#x4EE3;&#x78BC;&#x4EE5;&#x53CA;&#x7531;&#x6B64;&#x5E36;&#x4F86;&#x7684;&#x4EE3;&#x78BC;&#x8AA4;&#x522A;&#x9664;&#x7B49;&#x554F;&#x984C;&#x3002;</p>
<pre><code>$ cat test.c
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int main(void)
{
    int i = 0;

#ifdef DEBUG
        printf(&quot;i = %d\n&quot;, i);

        int t;
        __asm__ __volatile__ (&quot;movl %%ebp, %0;&quot;:&quot;=r&quot;(t)::&quot;%ebp&quot;);
        printf(&quot;ebp = 0x%x\n&quot;, t);
#endif

        _exit(0);
}
$ gcc -DDEBUG -g -o test test.c
$ ./test
i = 0
ebp = 0xbfb56d98
</code></pre><p>&#x4E0A;&#x9762;&#x6F14;&#x793A;&#x77AD;&#x5982;&#x4F55;&#x8DDF;&#x8E64;&#x666E;&#x901A;&#x8B8A;&#x91CF;&#x548C;&#x5BC4;&#x5B58;&#x5668;&#x8B8A;&#x91CF;&#x7684;&#x8FA6;&#x6CD5;&#x3002;&#x8DDF;&#x8E64;&#x5BC4;&#x5B58;&#x5668;&#x8B8A;&#x91CF;&#x63A1;&#x7528;&#x4E86;&#x5167;&#x806F;&#x5F59;&#x7DE8;&#x3002;</p>
<p>&#x4E0D;&#x904E;&#xFF0C;&#x9019;&#x7A2E;&#x65B9;&#x5F0F;&#x4E0D;&#x5920;&#x9748;&#x6D3B;&#xFF0C;&#x6211;&#x5011;&#x7121;&#x6CD5;&#x201C;&#x5373;&#x6642;&#x201D;&#x7372;&#x53D6;&#x7A0B;&#x5E8F;&#x7684;&#x57F7;&#x884C;&#x72C0;&#x614B;&#xFF0C;&#x800C; <code>gdb</code> &#x7B49;&#x4EA4;&#x4E92;&#x5F0F;&#x8ABF;&#x8A66;&#x5DE5;&#x5177;&#x4E0D;&#x50C5;&#x89E3;&#x6C7A;&#x4E86;&#x9019;&#x6A23;&#x7684;&#x554F;&#x984C;&#xFF0C;&#x800C;&#x4E14;&#x901A;&#x904E;&#x628A;&#x8ABF;&#x8A66;&#x5668;&#x62C6;&#x5206;&#x6210;&#x8ABF;&#x8A66;&#x670D;&#x52D9;&#x5668;&#x548C;&#x8ABF;&#x8A66;&#x5BA2;&#x6236;&#x7AEF;&#x9069;&#x61C9;&#x4E86;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x7684;&#x8ABF;&#x8A66;&#xFF0C;&#x53E6;&#x5916;&#xFF0C;&#x901A;&#x904E;&#x9810;&#x5148;&#x8A2D;&#x7F6E;&#x65B7;&#x9EDE;&#x4EE5;&#x53CA;&#x65B7;&#x9EDE;&#x8655;&#x9700;&#x8981;&#x6536;&#x96C6;&#x7684;&#x7A0B;&#x5E8F;&#x72C0;&#x614B;&#x4FE1;&#x606F;&#x89E3;&#x6C7A;&#x4E86;&#x4EA4;&#x4E92;&#x5F0F;&#x8ABF;&#x8A66;&#x4E0D;&#x9069;&#x61C9;&#x5BE6;&#x6642;&#x8ABF;&#x8A66;&#x7684;&#x554F;&#x984C;&#x3002;</p>
<p><span id="toc_7140_15195_12"></span></p>
<h3 id="%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%9A%84%E8%AA%BF%E8%A9%A6%EF%BC%88%E5%8B%95%E6%85%8B%E8%AA%BF%E8%A9%A6%EF%BC%89%EF%BC%9Agdb%EF%BC%88%E6%94%AF%E6%8C%81%E6%9C%AC%E5%9C%B0%E5%92%8C%E9%81%A0%E7%A8%8B%EF%BC%89-ald%EF%BC%88%E5%BD%99%E7%B7%A8%E6%8C%87%E4%BB%A4%E7%B4%9A%E5%88%A5%E7%9A%84%E8%AA%BF%E8%A9%A6%EF%BC%89">&#x4EA4;&#x4E92;&#x5F0F;&#x7684;&#x8ABF;&#x8A66;&#xFF08;&#x52D5;&#x614B;&#x8ABF;&#x8A66;&#xFF09;&#xFF1A;gdb&#xFF08;&#x652F;&#x6301;&#x672C;&#x5730;&#x548C;&#x9060;&#x7A0B;&#xFF09;/ald&#xFF08;&#x5F59;&#x7DE8;&#x6307;&#x4EE4;&#x7D1A;&#x5225;&#x7684;&#x8ABF;&#x8A66;&#xFF09;</h3>
<p><span id="toc_7140_15195_13"></span></p>
<h4 id="%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%B5%B1%E8%AA%BF%E8%A9%A6%E6%96%B9%E6%B3%95-gdbserver-gdb">&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x8ABF;&#x8A66;&#x65B9;&#x6CD5; gdbserver/gdb</h4>
<p>&#x4F30;&#x8A08;&#x5927;&#x5BB6;&#x5DF2;&#x7D93;&#x975E;&#x5E38;&#x719F;&#x6089; GDB&#xFF08;Gnu DeBugger&#xFF09;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x9019;&#x88E1;&#x4E26;&#x4E0D;&#x4ECB;&#x7D39;&#x5E38;&#x898F;&#x7684; <code>gdb</code> &#x7528;&#x6CD5;&#xFF0C;&#x800C;&#x662F;&#x4ECB;&#x7D39;&#x5B83;&#x7684;&#x670D;&#x52D9;&#x5668;&#xFF0F;&#x5BA2;&#x6236;&#xFF08;<code>gdbserver/gdb</code>&#xFF09;&#x8ABF;&#x8A66;&#x65B9;&#x5F0F;&#x3002;&#x9019;&#x7A2E;&#x65B9;&#x5F0F;&#x975E;&#x5E38;&#x9069;&#x5408;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x7684;&#x8ABF;&#x8A66;&#xFF0C;&#x70BA;&#x4EC0;&#x9EBC;&#x5462;&#xFF1F;&#x5148;&#x4F86;&#x770B;&#x770B;&#x9019;&#x500B;&#xFF1A;</p>
<pre><code>$ wc -c /usr/bin/gdbserver 
56000 /usr/bin/gdbserver
$ which gdb
/usr/bin/gdb
$ wc -c /usr/bin/gdb
2557324 /usr/bin/gdb
$ echo &quot;(2557324-56000)/2557324&quot;  | bc -l
.97810210986171482377
</code></pre><p><code>gdb</code> &#x6BD4; <code>gdbserver</code> &#x5927;&#x4E86;&#x5C07;&#x8FD1; 97%&#xFF0C;&#x5982;&#x679C;&#x628A;&#x6574;&#x500B; <code>gdb</code> &#x642C;&#x5230;&#x5B58;&#x5132;&#x7A7A;&#x9593;&#x53D7;&#x9650;&#x7684;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x4E2D;&#x662F;&#x5F88;&#x4E0D;&#x5408;&#x9069;&#x7684;&#xFF0C;&#x4E0D;&#x904E;&#x50C5;&#x50C5; 5K &#x5DE6;&#x53F3;&#x7684; <code>gdbserver</code> &#x5373;&#x4F7F;&#x5728;&#x53EA;&#x6709; 8M Flash &#x5361;&#x7684;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7D71;&#x4E2D;&#x4E5F;&#x90FD;&#x8DB3;&#x5920;&#x4E86;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x5D4C;&#x5165;&#x5F0F;&#x958B;&#x767C;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x901A;&#x5E38;&#x5148;&#x5728;&#x672C;&#x5730;&#x4E3B;&#x6A5F;&#x4E0A;&#x4EA4;&#x53C9;&#x7DE8;&#x8B6F;&#x597D; <code>gdbserver/gdb</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x662F;&#x521D;&#x6B21;&#x4F7F;&#x7528;&#x9019;&#x7A2E;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x80FD;&#x6703;&#x9047;&#x5230;&#x9EBB;&#x7169;&#xFF0C;&#x800C;&#x9EBB;&#x7169;&#x901A;&#x5E38;&#x767C;&#x751F;&#x5728;&#x4EA4;&#x53C9;&#x7DE8;&#x8B6F; <code>gdb</code> &#x548C; <code>gdbserver</code> &#x6642;&#x3002;&#x5728;&#x7DE8;&#x8B6F; <code>gdbserver/gdb</code> &#x524D;&#xFF0C;&#x9700;&#x8981;&#x914D;&#x7F6E;(./configure)&#x5169;&#x500B;&#x91CD;&#x8981;&#x7684;&#x9078;&#x9805;&#xFF1A;</p>
<ul>
<li><code>--host</code>&#xFF0C;&#x6307;&#x5B9A; gdb/gdbserver &#x672C;&#x8EAB;&#x7684;&#x904B;&#x884C;&#x5E73;&#x81FA;&#xFF0C;</li>
<li><code>--target</code>&#xFF0C;&#x6307;&#x5B9A; gdb/gdbserver &#x8ABF;&#x8A66;&#x7684;&#x4EE3;&#x78BC;&#x6240;&#x904B;&#x884C;&#x7684;&#x5E73;&#x81FA;&#xFF0C;</li>
</ul>
<p>&#x95DC;&#x65BC;&#x904B;&#x884C;&#x5E73;&#x81FA;&#xFF0C;&#x901A;&#x904E; <code>$MACHTYPE</code> &#x74B0;&#x5883;&#x8B8A;&#x91CF;&#x5C31;&#x53EF;&#x7372;&#x5F97;&#xFF0C;&#x5C0D;&#x65BC; <code>gdbserver</code>&#xFF0C;&#x56E0;&#x70BA;&#x8981;&#x628A;&#x5B83;&#x8907;&#x88FD;&#x5230;&#x5D4C;&#x5165;&#x5F0F;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x4E0A;&#xFF0C;&#x4E26;&#x4E14;&#x7528;&#x5B83;&#x4F86;&#x8ABF;&#x8A66;&#x76EE;&#x6A19;&#x5E73;&#x81FA;&#x4E0A;&#x7684;&#x4EE3;&#x78BC;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x628A; <code>--host</code> &#x548C; <code>--target</code> &#x90FD;&#x8A2D;&#x7F6E;&#x6210;&#x76EE;&#x6A19;&#x5E73;&#x81FA;&#xFF1B;&#x800C; <code>gdb</code> &#x56E0;&#x70BA;&#x9084;&#x662F;&#x904B;&#x884C;&#x5728;&#x672C;&#x5730;&#x4E3B;&#x6A5F;&#x4E0A;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x7528;&#x5B83;&#x8ABF;&#x8A66;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x4E0A;&#x7684;&#x4EE3;&#x78BC;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x628A; <code>--target</code> &#x8A2D;&#x7F6E;&#x6210;&#x76EE;&#x6A19;&#x5E73;&#x81FA;&#x3002;</p>
<p>&#x7DE8;&#x8B6F;&#x5B8C;&#x4EE5;&#x5F8C;&#x5C31;&#x662F;&#x8ABF;&#x8A66;&#xFF0C;&#x8ABF;&#x8A66;&#x6642;&#x9700;&#x8981;&#x628A;&#x7A0B;&#x5E8F;&#x4EA4;&#x53C9;&#x7DE8;&#x8B6F;&#x597D;&#xFF0C;&#x4E26;&#x628A;&#x4E8C;&#x9032;&#x5236;&#x6587;&#x4EF6;&#x8907;&#x88FD;&#x4E00;&#x4EFD;&#x5230;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x4E0A;&#xFF0C;&#x4E26;&#x5728;&#x672C;&#x5730;&#x9700;&#x8981;&#x4FDD;&#x7559;&#x4E00;&#x4EFD;&#x6E90;&#x4EE3;&#x78BC;&#x6587;&#x4EF6;&#x3002;&#x8ABF;&#x8A66;&#x904E;&#x7A0B;&#x5927;&#x9AD4;&#x5982;&#x4E0B;&#xFF0C;&#x9996;&#x5148;&#x5728;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x4E0A;&#x555F;&#x52D5;&#x8ABF;&#x8A66;&#x670D;&#x52D9;&#x5668;&#xFF1A;</p>
<pre><code>$ gdbserver :port /path/to/binary_file
...
</code></pre><p>&#x7136;&#x5F8C;&#x5728;&#x672C;&#x5730;&#x4E3B;&#x6A5F;&#x4E0A;&#x555F;&#x52D5;gdb&#x5BA2;&#x6236;&#x7AEF;&#x93C8;&#x63A5;&#x5230; <code>gdb</code> &#x8ABF;&#x8A66;&#x670D;&#x52D9;&#x5668;&#xFF0C;&#xFF08;<code>gdbserver_ipaddress</code> &#x662F;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x7684;IP&#x5730;&#x5740;&#xFF0C;&#x5982;&#x679C;&#x76EE;&#x6A19;&#x7CFB;&#x7D71;&#x4E0D;&#x652F;&#x6301;&#x7DB2;&#x7D61;&#xFF0C;&#x90A3;&#x9EBC;&#x53EF;&#x4EE5;&#x63A1;&#x7528;&#x4E32;&#x53E3;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5177;&#x9AD4;&#x770B;&#x624B;&#x518A;&#xFF09;</p>
<pre><code>$ gdb
...
(gdb) target remote gdbserver_ipaddress:2345
...
</code></pre><p>&#x5176;&#x4ED6;&#x8ABF;&#x8A66;&#x904E;&#x7A0B;&#x548C;&#x666E;&#x901A;&#x7684;gdb&#x8ABF;&#x8A66;&#x904E;&#x7A0B;&#x985E;&#x4F3C;&#x3002;</p>
<p><span id="toc_7140_15195_14"></span></p>
<h4 id="%E5%BD%99%E7%B7%A8%E4%BB%A3%E7%A2%BC%E7%9A%84%E8%AA%BF%E8%A9%A6-ald">&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#x7684;&#x8ABF;&#x8A66; ald</h4>
<p>&#x7528; <code>gdb</code> &#x8ABF;&#x8A66;&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#x8C8C;&#x4F3C;&#x6703;&#x6BD4;&#x8F03;&#x9EBB;&#x7169;&#xFF0C;&#x4E0D;&#x904E;&#x6709;&#x4EBA;&#x6B63;&#x662F;&#x56E0;&#x70BA;&#x9019;&#x500B;&#x539F;&#x56E0;&#x800C;&#x958B;&#x767C;&#x4E86;&#x4E00;&#x500B;&#x5C08;&#x9580;&#x7684;&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#x8ABF;&#x8A66;&#x5668;&#xFF0C;&#x540D;&#x5B57;&#x5C31;&#x53EB;&#x505A; <code>assembly language debugger</code>&#xFF0C;&#x7C21;&#x7A31; <code>ald</code>&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5F9E;<a href="http://ald.sourceforge.net/" target="_blank">&#x9019;&#x88E1;</a>&#x4E0B;&#x8F09;&#x5230;&#x3002;</p>
<p>&#x4E0B;&#x8F09;&#x5F8C;&#xFF0C;&#x89E3;&#x58D3;&#x7DE8;&#x8B6F;&#xFF0C;&#x6211;&#x5011;&#x4F86;&#x8ABF;&#x8A66;&#x4E00;&#x500B;&#x7A0B;&#x5E8F;&#x770B;&#x770B;&#x3002;</p>
<p>&#x9019;&#x88E1;&#x662F;&#x4E00;&#x6BB5;&#x975E;&#x5E38;&#x7C21;&#x77ED;&#x7684;&#x5F59;&#x7DE8;&#x4EE3;&#x78BC;&#xFF1A;</p>
<pre><code>.global _start 
_start:
        popl %ecx
        popl %ecx
        popl %ecx
        movb $10,12(%ecx) 
        xorl %edx, %edx
        movb $13, %dl
        xorl %eax, %eax 
        movb $4, %al 
        xorl %ebx, %ebx
        int $0x80 
        xorl %eax, %eax
        incl %eax        
        int $0x80
</code></pre><p>&#x5F59;&#x7DE8;&#x3001;&#x93C8;&#x63A5;&#x3001;&#x904B;&#x884C;&#xFF1A;</p>
<pre><code>$ as -o test.o test.s
$ ld -o test test.o
$ ./test &quot;Hello World&quot;
Hello World
</code></pre><p>&#x67E5;&#x770B;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x5730;&#x5740;&#xFF1A;</p>
<pre><code>$ readelf -h test | grep Entry 
  Entry point address:               0x8048054
</code></pre><p>&#x63A5;&#x8457;&#x7528; <code>ald</code> &#x8ABF;&#x8A66;&#xFF1A; </p>
<pre><code>$ ald test
ald&gt; display
Address 0x8048054 added to step display list
ald&gt; n
eax = 0x00000000 ebx = 0x00000000 ecx = 0x00000001 edx = 0x00000000 
esp = 0xBFBFDEB4 ebp = 0x00000000 esi = 0x00000000 edi = 0x00000000 
ds  = 0x007B es  = 0x007B fs  = 0x0000 gs  = 0x0000 
ss  = 0x007B cs  = 0x0073 eip = 0x08048055 eflags = 0x00200292 

Flags: AF SF IF ID 

Dumping 64 bytes of memory starting at 0x08048054 in hex
08048054:  59 59 59 C6 41 0C 0A 31 D2 B2 0D 31 C0 B0 04 31    YYY.A..1...1...1
08048064:  DB CD 80 31 C0 40 CD 80 00 2E 73 79 6D 74 61 62    ...1.@....symtab
08048074:  00 2E 73 74 72 74 61 62 00 2E 73 68 73 74 72 74    ..strtab..shstrt
08048084:  61 62 00 2E 74 65 78 74 00 00 00 00 00 00 00 00    ab..text........

08048055                      59                   pop ecx
</code></pre><p>&#x53EF;&#x898B; <code>ald</code> &#x5728;&#x555F;&#x52D5;&#x6642;&#x5C31;&#x5DF2;&#x7D93;&#x904B;&#x884C;&#x4E86;&#x88AB;&#x5B83;&#x8ABF;&#x8A66;&#x7684; <code>test</code> &#x7A0B;&#x5E8F;&#xFF0C;&#x4E26;&#x4E14;&#x9032;&#x5165;&#x4E86;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3; <code>0x8048054</code>&#xFF0C;&#x7DCA;&#x63A5;&#x8457;&#x55AE;&#x6B65;&#x57F7;&#x884C;&#x6642;&#xFF0C;&#x5C31;&#x57F7;&#x884C;&#x4E86;&#x7A0B;&#x5E8F;&#x7684;&#x7B2C;&#x4E00;&#x689D;&#x6307;&#x4EE4; <code>popl ecx</code>&#x3002;</p>
<p><code>ald</code> &#x7684;&#x547D;&#x4EE4;&#x5F88;&#x5C11;&#xFF0C;&#x800C;&#x4E14;&#x8DDF; <code>gdb</code> &#x5F88;&#x985E;&#x4F3C;&#xFF0C;&#x6BD4;&#x5982;&#x9019;&#x500B;&#x5E7E;&#x500B;&#x547D;&#x4EE4;&#x7528;&#x6CD5;&#x548C;&#x540D;&#x5B57;&#x90FD;&#x985E;&#x4F3C; <code>help,next,continue,set args,break,file,quit,disassemble,enable,disable</code> &#x7B49;&#x3002;&#x540D;&#x5B57;&#x4E0D;&#x592A;&#x4E00;&#x6A23;&#x4F46;&#x529F;&#x80FD;&#x5C0D;&#x7B49;&#x7684;&#x6709;&#xFF1A;<code>examine</code> &#x5C0D; <code>x</code>, <code>enter</code> &#x5C0D; <code>set variable {int} &#x5730;&#x5740;=&#x6578;&#x64DA;</code>&#x3002;</p>
<p>&#x9700;&#x8981;&#x63D0;&#x5230;&#x7684;&#x662F;&#xFF1A;Linux &#x4E0B;&#x7684;&#x8ABF;&#x8A66;&#x5668;&#x5305;&#x62EC;&#x4E0A;&#x9762;&#x7684; <code>gdb</code> &#x548C; <code>ald</code>&#xFF0C;&#x4EE5;&#x53CA; <code>strace</code> &#x7B49;&#x90FD;&#x7528;&#x5230;&#x4E86; Linux &#x7CFB;&#x7D71;&#x63D0;&#x4F9B;&#x7684; ptrace() &#x7CFB;&#x7D71;&#x8ABF;&#x7528;&#xFF0C;&#x9019;&#x500B;&#x8ABF;&#x7528;&#x70BA;&#x7528;&#x6236;&#x8A2A;&#x554F;&#x5167;&#x5B58;&#x6620;&#x50CF;&#x63D0;&#x4F9B;&#x4E86;&#x4FBF;&#x5229;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x81EA;&#x5DF1;&#x5BEB;&#x4E00;&#x500B;&#x8ABF;&#x8A66;&#x5668;&#x6216;&#x8005;&#x60F3;hack&#x4E00;&#x4E0B; <code>gdb</code> &#x548C; <code>ald</code>&#xFF0C;&#x90A3;&#x9EBC;&#x597D;&#x597D;&#x95B1;&#x8B80;&#x8CC7;&#x6599;<a href="http://linuxgazette.net/issue81/sandeep.html" target="_blank">12</a>&#x548C; <code>man ptrace</code> &#x5427;&#x3002;</p>
<p>&#x5982;&#x679C;&#x78BA;&#x5BE6;&#x9700;&#x8981;&#x7528;gdb&#x8ABF;&#x8A66;&#x5F59;&#x7DE8;&#xFF0C;&#x53EF;&#x4EE5;&#x53C3;&#x8003;&#xFF1A;</p>
<ul>
<li><a href="http://web.cecs.pdx.edu/~bjorn/CS200/linux_tutorial/" target="_blank">Linux Assembly &quot;Hello World&quot; Tutorial, CS 200</a></li>
<li><a href="http://lab46.corning-cc.edu/Documentation-Assembly_GDB_Debugger.php" target="_blank">Debugging your Alpha Assembly Programs using GDB</a></li>
</ul>
<p><span id="toc_7140_15195_15"></span></p>
<h3 id="%E5%AF%A6%E6%99%82%E8%AA%BF%E8%A9%A6%EF%BC%9Agdb-tracepoint">&#x5BE6;&#x6642;&#x8ABF;&#x8A66;&#xFF1A;gdb tracepoint</h3>
<p>&#x5C0D;&#x65BC;&#x7A0B;&#x5E8F;&#x72C0;&#x614B;&#x53D7;&#x6642;&#x9593;&#x5F71;&#x97FF;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x7528;&#x4E0A;&#x8FF0;&#x666E;&#x901A;&#x7684;&#x8A2D;&#x7F6E;&#x65B7;&#x9EDE;&#x7684;&#x4EA4;&#x4E92;&#x5F0F;&#x8ABF;&#x8A66;&#x65B9;&#x6CD5;&#x4E26;&#x4E0D;&#x5408;&#x9069;&#xFF0C;&#x56E0;&#x70BA;&#x9019;&#x7A2E;&#x65B9;&#x5F0F;&#x5C07;&#x7531;&#x65BC;&#x4EA4;&#x4E92;&#x6642;&#x7522;&#x751F;&#x7684;&#x901A;&#x4FE1;&#x5EF6;&#x9072;&#x548C;&#x7528;&#x6236;&#x8F38;&#x5165;&#x547D;&#x4EE4;&#x7684;&#x6642;&#x5EF6;&#x800C;&#x5B8C;&#x5168;&#x6539;&#x8B8A;&#x7A0B;&#x5E8F;&#x7684;&#x884C;&#x70BA;&#x3002;&#x6240;&#x4EE5; <code>gdb</code> &#x63D0;&#x51FA;&#x4E86;&#x4E00;&#x7A2E;&#x65B9;&#x6CD5;&#x4EE5;&#x4FBF;&#x9810;&#x5148;&#x8A2D;&#x7F6E;&#x65B7;&#x9EDE;&#x4EE5;&#x53CA;&#x5728;&#x65B7;&#x9EDE;&#x8655;&#x9700;&#x8981;&#x7372;&#x53D6;&#x7684;&#x7A0B;&#x5E8F;&#x72C0;&#x614B;&#xFF0C;&#x5F9E;&#x800C;&#x8B93;&#x8ABF;&#x8A66;&#x5668;&#x81EA;&#x52D5;&#x57F7;&#x884C;&#x65B7;&#x9EDE;&#x8655;&#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x7372;&#x53D6;&#x7A0B;&#x5E8F;&#x7684;&#x72C0;&#x614B;&#xFF0C;&#x5F9E;&#x800C;&#x907F;&#x514D;&#x5728;&#x65B7;&#x9EDE;&#x8655;&#x51FA;&#x73FE;&#x4EBA;&#x6A5F;&#x4EA4;&#x4E92;&#x7522;&#x751F;&#x6642;&#x5EF6;&#x6539;&#x8B8A;&#x7A0B;&#x5E8F;&#x7684;&#x884C;&#x70BA;&#x3002;</p>
<p>&#x9019;&#x7A2E;&#x65B9;&#x6CD5;&#x53EB; <code>tracepoints</code>&#xFF08;&#x5C0D;&#x61C9; <code>breakpoint</code>&#xFF09;&#xFF0C;&#x5B83;&#x5728; <code>gdb</code> &#x7684;&#x7528;&#x6236;&#x624B;&#x518A;&#x88E1;&#x982D;&#x6709;&#x8A73;&#x7D30;&#x7684;&#x8AAA;&#x660E;&#xFF0C;&#x898B; <a href="https://sourceware.org/gdb/onlinedocs/gdb/Tracepoints.html" target="_blank">Tracepoints</a>&#x3002;</p>
<p>&#x5728;&#x5167;&#x6838;&#x4E2D;&#xFF0C;&#x6709;&#x5BE6;&#x73FE;&#x4E86;&#x76F8;&#x61C9;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x53EB; <a href="http://lwn.net/Articles/538818/" target="_blank">KGTP</a>&#x3002;</p>
<p><span id="toc_7140_15195_16"></span></p>
<h3 id="%E8%AA%BF%E8%A9%A6%E5%85%A7%E6%A0%B8">&#x8ABF;&#x8A66;&#x5167;&#x6838;</h3>
<p>&#x96D6;&#x7136;&#x9019;&#x88E1;&#x4E26;&#x4E0D;&#x6703;&#x6F14;&#x793A;&#x5982;&#x4F55;&#x53BB; hack &#x5167;&#x6838;&#xFF0C;&#x4F46;&#x662F;&#x76F8;&#x95DC;&#x7684;&#x5DE5;&#x5177;&#x9084;&#x662F;&#x9700;&#x8981;&#x7C21;&#x55AE;&#x63D0;&#x5230;&#x7684;&#xFF0C;<a href="http://elinux.org/images/c/c6/Tools_slides.pdf" target="_blank">&#x9019;&#x500B;&#x8CC7;&#x6599;</a>&#x5217;&#x51FA;&#x4E86;&#x7D55;&#x5927;&#x90E8;&#x5206;&#x7528;&#x65BC;&#x5167;&#x6838;&#x8ABF;&#x8A66;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x9019;&#x4E9B;&#x5C0D;&#x4F60; hack &#x5167;&#x6838;&#x61C9;&#x8A72;&#x6703;&#x6709;&#x5E6B;&#x52A9;&#x7684;&#x3002;</p>
<p><span id="toc_7140_15195_17"></span></p>
<h2 id="%E4%BB%A3%E7%A2%BC%E5%84%AA%E5%8C%96">&#x4EE3;&#x78BC;&#x512A;&#x5316;</h2>
<p>&#x9019;&#x90E8;&#x5206;&#x66AB;&#x6642;&#x6C92;&#x6709;&#x6E96;&#x5099;&#x8DB3;&#x5920;&#x7684;&#x7D20;&#x6750;&#xFF0C;&#x6709;&#x5F85;&#x9032;&#x4E00;&#x6B65;&#x5B8C;&#x5584;&#x3002;</p>
<p>&#x66AB;&#x4E14;&#x5148;&#x63D0;&#x5230;&#x5169;&#x500B;&#x6BD4;&#x8F03;&#x91CD;&#x8981;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x4E00;&#x500B;&#x662F; Oprofile&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x500B;&#x662F; Perf&#x3002;</p>
<p>&#x5BE6;&#x969B;&#x4E0A;&#x5462;&#xFF1F;&#x201C;&#x4EE3;&#x78BC;&#x6E2C;&#x8A66;&#x201D;&#x90E8;&#x5206;&#x4ECB;&#x7D39;&#x7684;&#x5F88;&#x591A;&#x5DE5;&#x5177;&#x662F;&#x70BA;&#x4EE3;&#x78BC;&#x512A;&#x5316;&#x670D;&#x52D9;&#x7684;&#xFF0C;&#x66F4;&#x591A;&#x5177;&#x9AD4;&#x7684;&#x7D30;&#x7BC0;&#x8ACB;&#x53C3;&#x8003;&#x5F8C;&#x7E8C;&#x8CC7;&#x6599;&#xFF0C;&#x81EA;&#x5DF1;&#x505A;&#x5BE6;&#x9A57;&#x5427;&#x3002;</p>
<p><span id="toc_7140_15195_18"></span></p>
<h2 id="%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99">&#x53C3;&#x8003;&#x8CC7;&#x6599;</h2>
<ul>
<li><a href="http://satc.gsfc.nasa.gov/assure/agbsec5.txt" target="_blank">VERIFICATION AND VALIDATION</a></li>
<li><a href="http://www.faqs.org/qa/qa-9060.html" target="_blank">difference between verification and Validation</a></li>
<li><a href="http://www.linuxjournal.com/article/6758" target="_blank">Coverage Measurement and Profiling(&#x8986;&#x84CB;&#x5EA6;&#x6E2C;&#x91CF;&#x548C;&#x6027;&#x80FD;&#x6E2C;&#x8A66;,Gcov and Gprof)</a></li>
<li>Valgrind Usage<ul>
<li><a href="http://www.faqs.org/docs/Linux-HOWTO/Valgrind-HOWTO.html" target="_blank">Valgrind HOWTO</a></li>
<li><a href="http://www.cprogramming.com/debugging/valgrind.html" target="_blank">Using Valgrind to Find Memory Leaks and Invalid Memory Use</a></li>
</ul>
</li>
<li><a href="http://www.linkdata.se/sourcecode.html" target="_blank">MEMWATCH</a></li>
<li><a href="http://www.ibm.com/developerworks/linux/library/l-debug/" target="_blank">Mastering Linux debugging techniques</a></li>
<li><a href="http://arxiv.org/pdf/cs.PF/0507073.pdf" target="_blank">Software Performance Analysis</a></li>
<li><a href="http://dslab.lzu.edu.cn/docs/publications/runtime_debug.pdf" target="_blank">Runtime debugging in embedded systems</a></li>
<li><a href="http://www.xfocus.net/articles/200208/423.html" target="_blank">&#x7E5E;&#x904E;libsafe&#x7684;&#x4FDD;&#x8B77;--&#x8986;&#x84CB;_dl_lookup_versioned_symbol&#x6280;&#x8853;</a></li>
<li><a href="http://www.xfocus.net/articles/200103/78.html" target="_blank">&#x4ECB;&#x7D39;Propolice&#x600E;&#x6A23;&#x4FDD;&#x8B77;stack-smashing&#x7684;&#x653B;&#x64CA;</a></li>
<li>Tools Provided by System&#xFF1A;ltrace,mtrace,strace</li>
<li><a href="http://linuxgazette.net/issue81/sandeep.html" target="_blank">Process Tracing Using Ptrace</a></li>
<li>Kernel Debugging Related Tools&#xFF1A;KGDB, KGOV, KFI/KFT/Ftrace, GDB Tracepoint&#xFF0C;UML, kdb</li>
<li>&#x7528;Graphviz &#x53EF;&#x8996;&#x5316;&#x51FD;&#x6578;&#x8ABF;&#x7528;</li>
<li><a href="http://www.tinylab.org/explor-linux-segmentation-fault/" target="_blank">Linux &#x6BB5;&#x932F;&#x8AA4;&#x8A73;&#x89E3;</a></li>
<li>&#x6E90;&#x78BC;&#x5206;&#x6790;&#x4E4B;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x7E6A;&#x88FD;&#x7CFB;&#x5217;<ul>
<li><a href="http://www.tinylab.org/callgraph-draw-the-calltree-of-c-functions/" target="_blank">&#x6E90;&#x78BC;&#x5206;&#x6790;&#xFF1A;&#x975C;&#x614B;&#x5206;&#x6790; C &#x7A0B;&#x5E8F;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x5716;</a></li>
<li><a href="http://www.tinylab.org/source-code-analysis-gprof2dot-draw-a-runtime-function-calls-the-c-program/" target="_blank">&#x6E90;&#x78BC;&#x5206;&#x6790;&#xFF1A;&#x52D5;&#x614B;&#x5206;&#x6790; C &#x7A0B;&#x5E8F;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;</a></li>
<li><a href="http://www.tinylab.org/source-code-analysis-dynamic-analysis-of-linux-kernel-function-calls/" target="_blank">&#x6E90;&#x78BC;&#x5206;&#x6790;&#xFF1A;&#x52D5;&#x614B;&#x5206;&#x6790; Linux &#x5167;&#x6838;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;</a></li>
<li><a href="http://www.tinylab.org/source-code-analysis-how-best-to-draw-a-function-call/" target="_blank">&#x6E90;&#x78BC;&#x5206;&#x6790;&#xFF1A;&#x51FD;&#x6578;&#x8ABF;&#x7528;&#x95DC;&#x4FC2;&#x7E6A;&#x88FD;&#x65B9;&#x6CD5;&#x8207;&#x9006;&#x5411;&#x5EFA;&#x6A21;</a></li>
</ul>
</li>
<li>Linux &#x4E0B;&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x653B;&#x64CA;&#x7684;&#x539F;&#x7406;&#x53CA;&#x5C0D;&#x7B56;</li>
<li>Linux &#x5F59;&#x7DE8;&#x8A9E;&#x8A00;&#x958B;&#x767C;&#x6307;&#x5357;</li>
<li><a href="02-chapter5.html">&#x7DE9;&#x885D;&#x5340;&#x6EA2;&#x51FA;&#x8207;&#x6CE8;&#x5165;&#x5206;&#x6790;(&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#xFF1A;&#x9032;&#x7A0B;&#x7684;&#x5167;&#x5B58;&#x6620;&#x50CF;)</a></li>
<li>Optimizing C Code</li>
<li>Performance programming for scientific computing</li>
<li>Performance Programming</li>
<li>Linux Profiling and Optimization</li>
<li>High-level code optimization</li>
<li>Code Optimization</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../zh/chapters/02-chapter8.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 打造史上最小可執行ELF文件(45字節)"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-google_code_prettify/google-code-prettify.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-google_code_prettify/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-collapsible-menu/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-maxiang/maxiang.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
    </body>
    <!-- End of book C 語言編程透視 -->
</html>
